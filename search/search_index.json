{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"GREA","text":"<p>Welcome to the official documentation of GREA!</p>"},{"location":"#overview","title":"Overview","text":"<p>Gene Set Enrichment Analysis (GSEA) is a cornerstone for interpreting gene expression data, yet traditional approaches overlook gene interactions by focusing solely on individual genes, limiting their ability to detect subtle or complex pathway signals. To overcome this, we present GREA (Gene Interaction Enrichment Analysis), a novel framework that incorporates gene interaction data into enrichment analysis. GREA replaces the binary gene hit indicator with an interaction overlap ratio, capturing the degree of overlap between gene sets and gene interactions to enhance sensitivity and biological interpretability. It supports three enrichment metrics: Enrichment Score (ES), Enrichment Score Difference (ESD) from a Kolmogorov-Smirnov-based statistic, and Area Under the Curve (AUC) from a recovery curve. GREA evaluates statistical significance using both permutation testing and gamma distribution modeling. Benchmarking on transcriptomic datasets related to respiratory viral infections shows that GREA consistently outperforms existing tools such as blitzGSEA and GSEApy, identifying more relevant pathways with greater stability and reproducibility. By integrating gene interactions into pathway analysis, GREA offers a powerful and flexible tool for uncovering biologically meaningful insights in complex datasets.</p>"},{"location":"#getting-started","title":"Getting Started","text":"<p>Want to start using it immediately? Check out the Installation Guide.</p>"},{"location":"#tutorial-guide","title":"Tutorial Guide","text":"<p>The followings are tutorials of how to use GREA in different scenarios:</p> <ul> <li>Phenotype-level prerank enrichment for genes</li> <li>Phenotype-level prerank enrichment for gene interactions</li> <li>Observation-level prerank enrichment for genes</li> <li>Observation-level prerank enrichment for gene interactions</li> </ul>"},{"location":"#citation","title":"Citation","text":"<p>If you use GREA in your research, please cite the following paper:</p> <p>APA format:</p> <pre><code>Liu, X., Jiang, A., Lyu, C., &amp; Chen, L. (2025). Knowledge-driven annotation for gene interaction enrichment analysis. bioRxiv, 2025-04. https://doi.org/10.1101/2025.04.15.649030\n</code></pre> <p>BibTeX format:</p> <pre><code>@article{grea,\n  title={Knowledge-driven annotation for gene interaction enrichment analysis},\n  author={Liu, Xiaoyu and Jiang, Anna and Lyu, Chengshang and Chen, Lingxi},\n  journal={bioRxiv},\n  pages={2025--04},\n  year={2025},\n  doi={10.1101/2025.04.15.649030},\n  publisher={Cold Spring Harbor Laboratory}\n}\n</code></pre>"},{"location":"installation/","title":"Installation Guide","text":"<p>This guide explains how to install and configure GREA.</p>"},{"location":"installation/#prerequisites","title":"Prerequisites","text":"<p>Before installation, please ensure you have the following dependencies:</p> <ul> <li>Python &gt;= 3.12</li> <li>Other dependencies (if applicable)</li> </ul>"},{"location":"installation/#installation","title":"Installation","text":"<p>From GitHub (recommended for the latest version)</p> <pre><code>pip install git+https://github.com/compbioclub/GREA.git@dev\n</code></pre>"},{"location":"reference/","title":"Reference","text":"<ol> <li> <p>Almon, R. R., DuBois, D. C., Lai, W., Xue, B., Nie, J., &amp; Jusko, W. J. (2009). Gene expression analysis of hepatic roles in cause and development of diabetes in Goto-Kakizaki rats. Journal of Endocrinology, 200(3), 331-346.</p> </li> <li> <p>Lyu, C., Chen, L., &amp; Liu, X. (2024). Detecting tipping points of complex diseases by network information entropy. Briefings in bioinformatics, 25(4), bbae311.</p> </li> <li> <p>Huang, Y., Zaas, A. K., Rao, A., Dobigeon, N., Woolf, P. J., Veldman, T., ... &amp; Hero III, A. O. (2011). Temporal dynamics of host molecular responses differentiate symptomatic and asymptomatic influenza a infection. PLoS genetics, 7(8), e1002234.</p> </li> <li> <p>Lyu, C., Jiang, A., Ng, K. H., Liu, X., &amp; Chen, L. (2025). Predicting Early Transitions in Respiratory Virus Infections via Critical Transient Gene Interactions. bioRxiv, 2025-04.</p> </li> </ol>"},{"location":"tutorial/gene-obs_prerank_enrich/","title":"Observation-level prerank enrichment for genes","text":"<pre><code>%load_ext autoreload\n\nimport pandas as pd\nrank_df = pd.read_csv(\"grea/db/GSE13268_expr.csv\", index_col=0)\nrank_df.head()\n</code></pre> <pre>\n<code>The autoreload extension is already loaded. To reload it, use:\n  %reload_ext autoreload\n</code>\n</pre> GSM334850 GSM334851 GSM334852 GSM334853 GSM334854 GSM334855 GSM334856 GSM334857 GSM334858 GSM334859 ... GSM334941 GSM334942 GSM334943 GSM334944 GSM334945 GSM334946 GSM334947 GSM334948 GSM334949 GSM334950 symbol A1bg 3.571760 1.11627 11.55050 11.04560 2.742960 9.69463 7.40349 0.709628 7.526350 15.62100 ... 7.59029 0.450372 0.911598 8.24978 0.567557 6.796200 6.382740 2.34760 0.68466 11.23300 A1cf 48.075200 23.09380 47.03710 36.40960 28.652900 26.35890 33.77320 33.610200 27.605900 15.56650 ... 25.29960 20.527300 17.157700 31.47500 14.894300 22.987000 26.335800 24.31280 15.56490 29.42810 A2ml1 0.953989 2.70178 6.83848 2.23235 0.845507 1.59083 4.44694 2.506430 0.690331 1.04533 ... 4.27877 7.875130 1.937090 3.39644 6.506060 0.845852 0.871744 3.71262 5.47173 1.30705 A3galt2 55.093700 53.86570 66.91050 55.12170 61.720200 56.92840 53.99490 54.910100 60.342300 37.47140 ... 85.77660 74.817700 53.456900 79.28140 53.265400 71.644300 76.083200 80.58420 64.71110 79.28970 A4galt 18.853800 11.25860 4.73029 20.51850 11.892200 8.38279 17.57540 7.552850 13.629200 14.04210 ... 2.98861 2.015280 11.015100 3.56110 14.187100 3.654270 11.556800 14.73220 2.16436 11.30980 <p>5 rows \u00d7 101 columns</p> <pre><code>%autoreload\nfrom grea.library import list_libraries\n\nprint(list_libraries())\n</code></pre> <pre>\n<code>['GeneSigDB', 'Enrichr_Submissions_TF-Gene_Coocurrence', 'SysMyo_Muscle_Gene_Sets', 'WikiPathway_2021_Human', 'HomoloGene', 'WikiPathways_2013', 'PFOCR_Pathways_2023', 'OMIM_Disease', 'Data_Acquisition_Method_Most_Popular_Genes', 'NIBR_Jensen_DISEASES_Curated_2025', 'Cancer_Cell_Line_Encyclopedia', 'WikiPathways_2016', 'WikiPathways_2015', 'RNAseq_Automatic_GEO_Signatures_Human_Up', 'Human_Gene_Atlas', 'KOMP2_Mouse_Phenotypes_2022', 'MoTrPAC_2023', 'Kinase_Perturbations_from_GEO_down', 'Disease_Signatures_from_GEO_down_2014', 'Disease_Perturbations_from_GEO_up', 'Old_CMAP_down', 'MCF7_Perturbations_from_GEO_up', 'NIH_Funded_PIs_2017_GeneRIF_ARCHS4_Predictions', 'DepMap_WG_CRISPR_Screens_Sanger_CellLines_2019', 'PPI_Hub_Proteins', 'Disease_Signatures_from_GEO_up_2014', 'GTEx_Tissue_Expression_Up', 'NIBR_DRUGseq_2025_down', 'L1000_Kinase_and_GPCR_Perturbations_up', 'ARCHS4_Cell-lines', 'VirusMINT', 'KEGG_2019_Human', 'ARCHS4_Tissues', 'MGI_Mammalian_Phenotype_Level_4', 'The_Kinase_Library_2024', 'The_Kinase_Library_2023', 'MGI_Mammalian_Phenotype_Level_3', 'InterPro_Domains_2019', 'WikiPathways_2024_Mouse', 'DRUGseq_2025_up', 'KEGG_2015', 'MSigDB_Computational', 'KEGG_2013', 'TF-LOF_Expression_from_GEO', 'GWAS_Catalog_2019', 'KEGG_2016', 'NCI-Nature_2015', 'NCI-Nature_2016', 'CCLE_Proteomics_2020', 'PheWeb_2019', 'GeDiPNet_2023', 'RNA-Seq_Disease_Gene_and_Drug_Signatures_from_GEO', 'LINCS_L1000_Chem_Pert_down', 'Old_CMAP_up', 'LINCS_L1000_Ligand_Perturbations_down', 'Enrichr_Users_Contributed_Lists_2020', 'NIH_Funded_PIs_2017_Human_GeneRIF', 'Jensen_TISSUES', 'Azimuth_Cell_Types_2021', 'DisGeNET', 'Panther_2016', 'LINCS_L1000_Ligand_Perturbations_up', 'Rare_Diseases_AutoRIF_Gene_Lists', 'Achilles_fitness_increase', 'TargetScan_microRNA', 'Panther_2015', 'WikiPathways_2019_Mouse', 'ARCHS4_TFs_Coexp', 'LINCS_L1000_Chem_Pert_up', 'MSigDB_Oncogenic_Signatures', 'Gene_Perturbations_from_GEO_down', 'Table_Mining_of_CRISPR_Studies', 'Rare_Diseases_GeneRIF_Gene_Lists', 'Ligand_Perturbations_from_GEO_down', 'SILAC_Phosphoproteomics', 'Ligand_Perturbations_from_GEO_up', 'Drug_Perturbations_from_GEO_up', 'SynGO_2022', 'MGI_Mammalian_Phenotype_Level_4_2024', 'SynGO_2024', 'Allen_Brain_Atlas_10x_scRNA_2021', 'MGI_Mammalian_Phenotype_Level_4_2021', 'ClinVar_2019', 'GWAS_Catalog_2023', 'MAGMA_Drugs_and_Diseases', 'KEA_2015', 'KEA_2013', 'Microbe_Perturbations_from_GEO_up', 'Chromosome_Location', 'COVID-19_Related_Gene_Sets_2021', 'MGI_Mammalian_Phenotype_Level_4_2019', 'DRUGseqr_2025_down', 'ARCHS4_IDG_Coexp', 'NIH_Funded_PIs_2017_AutoRIF_ARCHS4_Predictions', 'Jensen_DISEASES_Experimental_2025', 'lncHUB_lncRNA_Co-Expression', 'PerturbAtlas', 'DrugMatrix', 'Virus_Perturbations_from_GEO_down', 'huMAP', 'L1000_Kinase_and_GPCR_Perturbations_down', 'Elsevier_Pathway_Collection', 'NIH_Funded_PIs_2017_Human_AutoRIF', 'Diabetes_Perturbations_GEO_2022', 'ESCAPE', 'RNAseq_Automatic_GEO_Signatures_Mouse_Down', 'UK_Biobank_GWAS_v1', 'Aging_Perturbations_from_GEO_up', 'Human_Phenotype_Ontology', 'Jensen_DISEASES_Curated_2025', 'Proteomics_Drug_Atlas_2023', 'dbGaP', 'SubCell_BarCode', 'Transcription_Factor_PPIs', 'GO_Cellular_Component_2017b', 'HuBMAP_ASCTplusB_augmented_2022', 'MSigDB_Hallmark_2020', 'GlyGen_Glycosylated_Proteins_2022', 'MAGNET_2023', 'CellMarker_2024', 'BioPlanet_2019', 'HDSigDB_Human_2021', 'GTEx_Tissues_V8_2023', 'GTEx_Tissue_Expression_Down', 'Metabolomics_Workbench_Metabolites_2022', 'Tissue_Protein_Expression_from_Human_Proteome_Map', 'Epigenomics_Roadmap_HM_ChIP-seq', 'PhenGenI_Association_2021', 'MCF7_Perturbations_from_GEO_down', 'ProteomicsDB_2020', 'Virus-Host_PPI_P-HIPSTer_2020', 'OMIM_Expanded', 'Reactome_2022', 'Genes_Associated_with_NIH_Grants', 'CellMarker_Augmented_2021', 'ENCODE_and_ChEA_Consensus_TFs_from_ChIP-X', 'HDSigDB_Mouse_2021', 'Jensen_COMPARTMENTS', 'ChEA_2015', 'ChEA_2016', 'KEGG_2019_Mouse', 'ChEA_2022', 'LINCS_L1000_Chem_Pert_Consensus_Sigs', 'Drug_Perturbations_from_GEO_2014', 'TargetScan_microRNA_2017', 'KEGG_2021_Mouse', 'Allen_Brain_Atlas_down', 'WikiPathways_2019_Human', 'Reactome_2013', 'BioCarta_2013', 'Rummagene_transcription_factors', 'Gene_Perturbations_from_GEO_up', 'GO_Cellular_Component_2015', 'Rummagene-signatures', 'GO_Cellular_Component_2013', 'BioCarta_2016', 'NIBR_Jensen_DISEASES_Experimental_2025', 'BioCarta_2015', 'Reactome_2015', 'Reactome_2016', 'GO_Cellular_Component_2018', 'GO_Cellular_Component_2017', 'GO_Cellular_Component_2023', 'GO_Cellular_Component_2021', 'WikiPathway_2021_Mouse', 'ENCODE_TF_ChIP-seq_2015', 'ENCODE_TF_ChIP-seq_2014', 'RNAseq_Automatic_GEO_Signatures_Mouse_Up', 'GO_Molecular_Function_2017b', 'DRUGseq_2025_down', 'FANTOM6_lncRNA_KD_DEGs', 'MGI_Mammalian_Phenotype_2013', 'GO_Cellular_Component_2025', 'HMS_LINCS_KinomeScan', 'NCI-60_Cancer_Cell_Lines', 'Azimuth_2023', 'MGI_Mammalian_Phenotype_2017', 'Rare_Diseases_GeneRIF_ARCHS4_Predictions', 'Virus_Perturbations_from_GEO_up', 'PFOCR_Pathways', 'IDG_Drug_Targets_2022', 'Enrichr_Libraries_Most_Popular_Genes', 'Orphanet_Augmented_2021', 'NIBR_DRUGseq_2025_up', 'GO_Biological_Process_2021', 'TRANSFAC_and_JASPAR_PWMs', 'Reactome_Pathways_2024', 'GO_Biological_Process_2023', 'Rare_Diseases_AutoRIF_ARCHS4_Predictions', 'COVID-19_Related_Gene_Sets', 'Kinase_Perturbations_from_GEO_up', 'Descartes_Cell_Types_and_Tissue_2021', 'Tabula_Muris', 'Tabula_Sapiens', 'GO_Biological_Process_2025', 'TF_Perturbations_Followed_by_Expression', 'Rummagene_kinases', 'GTEx_Aging_Signatures_2021', 'WikiPathways_2024_Human', 'Tissue_Protein_Expression_from_ProteomicsDB', 'DGIdb_Drug_Targets_2024', 'Serine_Threonine_Kinome_Atlas_2023', 'Aging_Perturbations_from_GEO_down', 'DepMap_CRISPR_GeneDependency_CellLines_2023', 'GO_Biological_Process_2013', 'GO_Biological_Process_2017b', 'GO_Biological_Process_2018', 'CORUM', 'GO_Biological_Process_2015', 'Phosphatase_Substrates_from_DEPOD', 'BioPlex_2017', 'TRRUST_Transcription_Factors_2019', 'GO_Biological_Process_2017', 'Pfam_InterPro_Domains', 'HuBMAP_ASCT_plus_B_augmented_w_RNAseq_Coexpression', 'Pfam_Domains_2019', 'WikiPathway_2023_Human', 'Allen_Brain_Atlas_up', 'Genome_Browser_PWMs', 'NURSA_Human_Endogenous_Complexome', 'HumanCyc_2015', 'HumanCyc_2016', 'Rummagene_signatures', 'Chromosome_Location_hg19', 'Mouse_Gene_Atlas', 'ChEA_2013', 'miRTarBase_2017', 'GO_Molecular_Function_2023', 'Jensen_DISEASES', 'RNAseq_Automatic_GEO_Signatures_Human_Down', 'GO_Molecular_Function_2025', 'Rummagene-transcription-factors', 'ARCHS4_Kinases_Coexp', 'Microbe_Perturbations_from_GEO_down', 'DRUGseqr_2025_up', 'PanglaoDB_Augmented_2021', 'ENCODE_Histone_Modifications_2013', 'ENCODE_Histone_Modifications_2015', 'Achilles_fitness_decrease', 'DSigDB', 'DepMap_WG_CRISPR_Screens_Broad_CellLines_2019', 'Disease_Perturbations_from_GEO_down', 'Drug_Perturbations_from_GEO_down', 'GO_Molecular_Function_2021', 'GO_Molecular_Function_2017', 'GO_Molecular_Function_2018', 'Mitchell_Proteomics_Drug_Atlas_2023', 'GO_Molecular_Function_2013', 'GO_Molecular_Function_2015', 'Rummagene-kinases', 'TG_GATES_2020', 'KEGG_2021_Human', 'HMDB_Metabolites', 'LINCS_L1000_CRISPR_KO_Consensus_Sigs']\n</code>\n</pre> <pre><code>%autoreload\n\nfrom grea import grea\nlibraries = ['WikiPathways_2024_Mouse']\nobj = grea.obs_prerank_enrich(rank_df, libraries)\nobj\n</code></pre> <pre>\n<code>---Finished: Load WikiPathways_2024_Mouse with 188 terms.\n---WARMING: 100.0% of entries has zero overlap ratio.\nPlease check the consistency (upper/lower case) of signature names in rand_df and libraries.\nCurrent rand_df sig name: A1bg, library sig name: NQO1\nCurrent setting - sig_upper=True\n</code>\n</pre> <pre>\n<code>&lt;grea.grea._GREA at 0x29d270c7a70&gt;</code>\n</pre> <pre><code>%autoreload\n\ndf = obj.get_enrich_results(metric='KS-ES')\ndf\n</code></pre> Term Obs KS-ES N_lead_sigs Lead_sigs 73 WikiPathways_2024_Mouse|Cytoplasmic Ribosomal ... GSM334872 0.981638 27 Rps4x;Rpl26;Rps23;Rpl3;Rpl18a;Rps27a;Rps24;Rpl... 73 WikiPathways_2024_Mouse|Cytoplasmic Ribosomal ... GSM334882 0.980820 27 Rpl26;Rps4x;Rps23;Rpl3;Rpl18a;Rps15a;Rps24;Rpl... 37 WikiPathways_2024_Mouse|Peroxiredoxin 2 Induce... GSM334871 0.980468 3 Cyp11a1;Star;Prdx2 73 WikiPathways_2024_Mouse|Cytoplasmic Ribosomal ... GSM334943 0.979097 27 Rpl26;Rps23;Rps4x;Rps24;Rpl18a;Rpl19;Rpl3;Rps8... 73 WikiPathways_2024_Mouse|Cytoplasmic Ribosomal ... GSM334890 0.978595 27 Rps4x;Rpl26;Rps23;Rps24;Rpl18a;Rpl11;Rpl3;Rpl1... ... ... ... ... ... ... 4 WikiPathways_2024_Mouse|Eicosanoid Metabolism ... GSM334880 -0.834127 2 Cyp2c23;Ppara 4 WikiPathways_2024_Mouse|Eicosanoid Metabolism ... GSM334903 -0.844580 2 Cyp2c23;Ppara 4 WikiPathways_2024_Mouse|Eicosanoid Metabolism ... GSM334949 -0.872260 2 Cyp2c23;Ppara 4 WikiPathways_2024_Mouse|Eicosanoid Metabolism ... GSM334950 -0.873169 2 Cyp2c23;Ppara 4 WikiPathways_2024_Mouse|Eicosanoid Metabolism ... GSM334882 -0.882219 2 Cyp2c23;Ppara <p>18988 rows \u00d7 5 columns</p> <pre><code>%autoreload\n\ndf = obj.get_enrich_score(metric='KS-ES')\ndf\n</code></pre> GSM334850 GSM334851 GSM334852 GSM334853 GSM334854 GSM334855 GSM334856 GSM334857 GSM334858 GSM334859 ... GSM334941 GSM334942 GSM334943 GSM334944 GSM334945 GSM334946 GSM334947 GSM334948 GSM334949 GSM334950 WikiPathways_2024_Mouse|Transcriptional Activation By Nfe2l2 Response To Phytochemicals WP1245 0.412830 0.467998 0.436660 0.458399 0.462322 0.395814 0.440631 0.427856 0.504467 0.426130 ... 0.570103 0.609538 0.614854 0.580669 0.555469 0.566584 0.621786 0.580979 0.618088 0.533673 WikiPathways_2024_Mouse|Cholesterol Metabolism W Bloch And Kandutsch Russell Pathways WP4346 0.670548 0.649544 0.673325 0.726577 0.634954 0.605772 0.648493 0.634346 0.602966 0.593843 ... 0.647829 0.681657 0.662473 0.656324 0.633617 0.630928 0.664833 0.605766 0.635952 0.635421 WikiPathways_2024_Mouse|Ethanol Metabolism Resulting In Production Of ROS By CYP2E1 WP4265 0.341948 0.198178 0.243526 0.279609 0.277841 0.264209 0.385532 0.268891 0.249796 0.197347 ... 0.301717 0.291126 0.305152 0.318816 0.258572 0.312139 0.347613 0.295290 0.338123 0.302688 WikiPathways_2024_Mouse|Dysregulated miRNA Targeting In Insulin PI3K AKT Signaling WP3855 0.864432 0.866824 0.876477 0.892865 0.859135 0.855858 0.870907 0.871072 0.881901 0.881987 ... 0.855171 0.847003 0.816605 0.816138 0.811848 0.804385 0.795185 0.831287 0.814979 0.836070 WikiPathways_2024_Mouse|Eicosanoid Metabolism Via Cytochrome P450 Monooxygenases WP4349 -0.570016 -0.661496 -0.527145 -0.560909 -0.653584 -0.745868 -0.611986 -0.754485 -0.713905 -0.741716 ... -0.544996 -0.452423 -0.617188 -0.548674 -0.734372 -0.768024 -0.778717 -0.776660 -0.872260 -0.873169 ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... WikiPathways_2024_Mouse|Methylation WP1247 0.391970 0.324458 0.328212 0.332118 0.386053 0.362876 0.418902 0.326840 0.327292 0.406575 ... 0.457257 0.519223 0.515295 0.512668 0.480336 0.496474 0.489760 0.477241 0.454640 0.518497 WikiPathways_2024_Mouse|Mapk Cascade WP251 0.568139 0.580301 0.609159 0.565462 0.556724 0.495847 0.499219 0.519504 0.571507 0.558285 ... 0.412599 0.418264 0.450851 0.409032 0.457314 0.486550 0.478074 0.396986 0.455132 0.491183 WikiPathways_2024_Mouse|Apoptosis WP1254 0.294739 0.281215 0.322398 0.326298 0.289497 0.358050 0.369617 0.327916 0.311259 0.281115 ... 0.384741 0.377897 0.384152 0.336996 0.380882 0.374894 0.357647 0.362886 0.410473 0.349025 WikiPathways_2024_Mouse|GPCRs Other WP41 -0.512467 -0.480542 -0.472730 -0.454921 -0.475378 -0.470748 -0.440662 -0.442404 -0.511002 -0.507203 ... -0.451471 -0.457074 -0.479113 -0.458720 -0.463978 -0.445054 -0.477035 -0.448287 -0.459994 -0.437742 WikiPathways_2024_Mouse|TCA Cycle WP434 0.912299 0.926151 0.906870 0.925250 0.919301 0.907569 0.902905 0.904835 0.913677 0.906402 ... 0.885823 0.884007 0.876870 0.892901 0.882622 0.881128 0.873515 0.876634 0.886494 0.875674 <p>188 rows \u00d7 101 columns</p> <pre><code>%autoreload\n\ndf = obj.get_enrich_results(metric='KS-ESD')\ndf\n</code></pre> Term Obs KS-ESD N_lead_sigs Lead_sigs 73 WikiPathways_2024_Mouse|Cytoplasmic Ribosomal ... GSM334872 0.980696 27 Rps4x;Rpl26;Rps23;Rpl3;Rpl18a;Rps27a;Rps24;Rpl... 73 WikiPathways_2024_Mouse|Cytoplasmic Ribosomal ... GSM334882 0.980035 27 Rpl26;Rps4x;Rps23;Rpl3;Rpl18a;Rps15a;Rps24;Rpl... 37 WikiPathways_2024_Mouse|Peroxiredoxin 2 Induce... GSM334871 0.979685 3 Cyp11a1;Star;Prdx2 73 WikiPathways_2024_Mouse|Cytoplasmic Ribosomal ... GSM334943 0.978154 27 Rpl26;Rps23;Rps4x;Rps24;Rpl18a;Rpl19;Rpl3;Rps8... 73 WikiPathways_2024_Mouse|Cytoplasmic Ribosomal ... GSM334896 0.977635 27 Rpl26;Rps4x;Rps23;Rpl18a;Rpl3;Rps24;Rps15a;Rpl... ... ... ... ... ... ... 4 WikiPathways_2024_Mouse|Eicosanoid Metabolism ... GSM334908 -0.767813 2 Ppara;Cyp2c23 4 WikiPathways_2024_Mouse|Eicosanoid Metabolism ... GSM334903 -0.773683 2 Cyp2c23;Ppara 4 WikiPathways_2024_Mouse|Eicosanoid Metabolism ... GSM334949 -0.798073 2 Cyp2c23;Ppara 4 WikiPathways_2024_Mouse|Eicosanoid Metabolism ... GSM334882 -0.804115 2 Cyp2c23;Ppara 4 WikiPathways_2024_Mouse|Eicosanoid Metabolism ... GSM334950 -0.824991 2 Cyp2c23;Ppara <p>18988 rows \u00d7 5 columns</p> <pre><code>%autoreload\n\ndf = obj.get_enrich_score(metric='KS-ESD')\ndf\n</code></pre> GSM334850 GSM334851 GSM334852 GSM334853 GSM334854 GSM334855 GSM334856 GSM334857 GSM334858 GSM334859 ... GSM334941 GSM334942 GSM334943 GSM334944 GSM334945 GSM334946 GSM334947 GSM334948 GSM334949 GSM334950 WikiPathways_2024_Mouse|Transcriptional Activation By Nfe2l2 Response To Phytochemicals WP1245 0.324636 0.414611 0.372847 0.406815 0.405251 0.322672 0.390537 0.362867 0.451002 0.353223 ... 0.529965 0.569557 0.575735 0.538415 0.512901 0.528249 0.576160 0.538019 0.575442 0.485774 WikiPathways_2024_Mouse|Cholesterol Metabolism W Bloch And Kandutsch Russell Pathways WP4346 0.669448 0.645677 0.668263 0.726420 0.634168 0.591900 0.647550 0.632460 0.600765 0.591249 ... 0.646493 0.680242 0.660744 0.654909 0.632123 0.629592 0.662554 0.595761 0.634616 0.634085 WikiPathways_2024_Mouse|Ethanol Metabolism Resulting In Production Of ROS By CYP2E1 WP4265 0.210511 0.061569 0.112168 0.147624 0.159964 0.135571 0.250255 0.145292 0.151434 0.070064 ... 0.200377 0.198721 0.199109 0.205641 0.145710 0.209388 0.259440 0.183291 0.234980 0.188338 WikiPathways_2024_Mouse|Dysregulated miRNA Targeting In Insulin PI3K AKT Signaling WP3855 0.864118 0.866510 0.876320 0.892786 0.859135 0.855623 0.870907 0.870836 0.881822 0.881830 ... 0.854543 0.845983 0.813702 0.814177 0.810906 0.803601 0.794086 0.830895 0.814273 0.835835 WikiPathways_2024_Mouse|Eicosanoid Metabolism Via Cytochrome P450 Monooxygenases WP4349 -0.413965 -0.536467 -0.467293 -0.334978 -0.569683 -0.616295 -0.552683 -0.550725 -0.584881 -0.662515 ... -0.288425 -0.270299 -0.548752 -0.463362 -0.713142 -0.702063 -0.740096 -0.719864 -0.798073 -0.824991 ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... WikiPathways_2024_Mouse|Methylation WP1247 0.228440 0.101532 0.168696 0.188356 0.260204 0.182830 0.258322 0.116430 0.060950 0.203101 ... 0.310465 0.446882 0.443503 0.439230 0.349936 0.412625 0.432075 0.283084 0.379164 0.331828 WikiPathways_2024_Mouse|Mapk Cascade WP251 0.514322 0.548058 0.586095 0.553223 0.503849 0.412848 0.454424 0.444349 0.497450 0.487052 ... 0.317047 0.359270 0.391386 0.313480 0.386239 0.410768 0.436182 0.287392 0.376996 0.414930 WikiPathways_2024_Mouse|Apoptosis WP1254 0.281438 0.264137 0.313111 0.319529 0.277613 0.346480 0.360881 0.317291 0.284893 0.257347 ... 0.381986 0.374434 0.380296 0.332746 0.367423 0.373163 0.352531 0.359974 0.408663 0.346821 WikiPathways_2024_Mouse|GPCRs Other WP41 -0.500362 -0.469012 -0.444671 -0.399914 -0.462654 -0.443355 -0.376171 -0.418668 -0.500155 -0.493605 ... -0.431743 -0.436391 -0.428427 -0.431691 -0.437685 -0.412836 -0.426068 -0.437598 -0.420218 -0.422887 WikiPathways_2024_Mouse|TCA Cycle WP434 0.908296 0.922305 0.902082 0.922502 0.915691 0.901368 0.896940 0.899106 0.907555 0.899573 ... 0.880171 0.877257 0.869257 0.885994 0.877834 0.875712 0.863547 0.868942 0.878409 0.869473 <p>188 rows \u00d7 101 columns</p> <pre><code>%autoreload\n\ndf = obj.get_enrich_results(metric='RC-AUC')\ndf\n</code></pre> Term Obs RC-AUC 172 WikiPathways_2024_Mouse|mRNA Processing WP310 GSM334869 148671.416845 172 WikiPathways_2024_Mouse|mRNA Processing WP310 GSM334882 143134.458796 172 WikiPathways_2024_Mouse|mRNA Processing WP310 GSM334859 140356.589438 172 WikiPathways_2024_Mouse|mRNA Processing WP310 GSM334872 139825.309173 172 WikiPathways_2024_Mouse|mRNA Processing WP310 GSM334896 139609.507810 ... ... ... ... 4 WikiPathways_2024_Mouse|Eicosanoid Metabolism ... GSM334922 73.006146 4 WikiPathways_2024_Mouse|Eicosanoid Metabolism ... GSM334901 70.024766 4 WikiPathways_2024_Mouse|Eicosanoid Metabolism ... GSM334949 61.704440 4 WikiPathways_2024_Mouse|Eicosanoid Metabolism ... GSM334950 61.675580 4 WikiPathways_2024_Mouse|Eicosanoid Metabolism ... GSM334882 59.670673 <p>18988 rows \u00d7 3 columns</p> <pre><code>%autoreload\n\ndf = obj.get_enrich_score(metric='RC-AUC')\ndf\n</code></pre> GSM334850 GSM334851 GSM334852 GSM334853 GSM334854 GSM334855 GSM334856 GSM334857 GSM334858 GSM334859 ... GSM334941 GSM334942 GSM334943 GSM334944 GSM334945 GSM334946 GSM334947 GSM334948 GSM334949 GSM334950 WikiPathways_2024_Mouse|Transcriptional Activation By Nfe2l2 Response To Phytochemicals WP1245 1728.159905 2351.103532 1994.681650 2318.750721 2124.519332 1786.577461 2037.191753 1963.697246 2556.636274 2039.257692 ... 2960.736947 3081.768920 2775.771963 2629.290437 2797.675872 2966.597562 2462.900167 2861.366643 2670.161927 2336.667330 WikiPathways_2024_Mouse|Cholesterol Metabolism W Bloch And Kandutsch Russell Pathways WP4346 20688.145673 21519.565627 23312.020514 29248.000321 19713.434477 17226.990813 19367.233450 18719.107988 17935.757995 16563.729070 ... 18767.697946 20967.258874 17934.822221 18708.982835 17179.245136 16114.756826 16507.815746 17462.773144 16965.077818 19301.640667 WikiPathways_2024_Mouse|Ethanol Metabolism Resulting In Production Of ROS By CYP2E1 WP4265 1023.745856 911.661212 983.972585 1096.868488 1001.103676 982.600984 971.049459 1005.950343 1071.902190 926.442363 ... 1182.450902 1226.531318 1034.089830 1199.008140 1167.276825 1196.757060 1314.165628 1147.363710 1266.944014 1151.462087 WikiPathways_2024_Mouse|Dysregulated miRNA Targeting In Insulin PI3K AKT Signaling WP3855 39726.878808 41627.175102 46627.269194 50927.879857 36336.886247 34714.694557 35177.101932 37508.667294 41260.526039 36984.613741 ... 26517.379068 25930.254750 18693.657107 20831.691892 23363.216524 21622.859773 18004.134150 26077.948230 22983.837724 24360.593427 WikiPathways_2024_Mouse|Eicosanoid Metabolism Via Cytochrome P450 Monooxygenases WP4349 187.682448 200.331111 190.896766 233.522505 176.858608 154.872949 168.269473 190.375199 200.214553 131.730134 ... 350.644897 328.080797 205.871278 183.904791 107.869725 107.549898 98.609554 83.443487 61.704440 61.675580 ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... WikiPathways_2024_Mouse|Methylation WP1247 1481.948801 1224.450461 1361.148764 1399.913313 1424.781201 1386.866406 1605.121929 1408.186714 1236.608362 1443.029129 ... 1623.589344 1770.760143 1703.623446 1790.013073 1759.882434 1844.485101 1834.214229 1611.350068 1526.379280 1714.140654 WikiPathways_2024_Mouse|Mapk Cascade WP251 3427.687671 4034.010351 4422.693700 5030.750866 3370.679990 2868.445878 2871.973947 2967.901472 3850.362810 3289.628499 ... 2463.822619 2679.224104 2298.827271 2351.364082 2881.077748 2794.818044 2749.948464 2315.948391 2535.283040 2968.940484 WikiPathways_2024_Mouse|Apoptosis WP1254 10567.592020 10766.750221 11657.932840 11707.904993 10382.825052 10781.325318 10793.048680 11171.568666 11026.948495 10167.164672 ... 11497.183967 11429.440076 11889.214336 11254.810942 12013.964218 11368.323225 10872.636887 11376.315769 12485.504708 10794.229008 WikiPathways_2024_Mouse|GPCRs Other WP41 2856.426317 3132.065709 3174.962629 3475.190170 2993.871071 3152.421231 3158.894479 3176.904616 2857.734516 2827.617066 ... 2936.438541 2773.645067 3012.127277 2844.652589 3013.148814 2958.982715 3167.991805 2780.083217 3054.315818 2936.208732 WikiPathways_2024_Mouse|TCA Cycle WP434 50289.386611 55501.381648 49935.125548 55392.068375 47886.909152 45631.450323 40506.109989 46944.951604 54789.106472 45650.056483 ... 30295.900070 33342.118782 26035.030690 35840.847604 28130.964698 26015.183058 25263.765249 31271.632958 26681.648514 27804.969734 <p>188 rows \u00d7 101 columns</p> <pre><code>%autoreload\n\ndf = obj.get_enrich_results(metric='RC-nAUC')\ndf\n</code></pre> Term Obs RC-nAUC 73 WikiPathways_2024_Mouse|Cytoplasmic Ribosomal ... GSM334869 3757.080794 73 WikiPathways_2024_Mouse|Cytoplasmic Ribosomal ... GSM334919 3753.980702 73 WikiPathways_2024_Mouse|Cytoplasmic Ribosomal ... GSM334896 3639.503472 73 WikiPathways_2024_Mouse|Cytoplasmic Ribosomal ... GSM334882 3559.959174 73 WikiPathways_2024_Mouse|Cytoplasmic Ribosomal ... GSM334872 3528.439808 ... ... ... ... 4 WikiPathways_2024_Mouse|Eicosanoid Metabolism ... GSM334922 24.335382 4 WikiPathways_2024_Mouse|Eicosanoid Metabolism ... GSM334901 23.341589 4 WikiPathways_2024_Mouse|Eicosanoid Metabolism ... GSM334949 20.568147 4 WikiPathways_2024_Mouse|Eicosanoid Metabolism ... GSM334950 20.558527 4 WikiPathways_2024_Mouse|Eicosanoid Metabolism ... GSM334882 19.890224 <p>18988 rows \u00d7 3 columns</p> <pre><code>%autoreload\n\ndf = obj.get_enrich_score(metric='RC-nAUC')\ndf\n</code></pre> GSM334850 GSM334851 GSM334852 GSM334853 GSM334854 GSM334855 GSM334856 GSM334857 GSM334858 GSM334859 ... GSM334941 GSM334942 GSM334943 GSM334944 GSM334945 GSM334946 GSM334947 GSM334948 GSM334949 GSM334950 WikiPathways_2024_Mouse|Transcriptional Activation By Nfe2l2 Response To Phytochemicals WP1245 144.013325 195.925294 166.223471 193.229227 177.043278 148.881455 169.765979 163.641437 213.053023 169.938141 ... 246.728079 256.814077 231.314330 219.107536 233.139656 247.216464 205.241681 238.447220 222.513494 194.722278 WikiPathways_2024_Mouse|Cholesterol Metabolism W Bloch And Kandutsch Russell Pathways WP4346 459.736571 478.212569 518.044900 649.955563 438.076322 382.822018 430.382966 415.980178 398.572400 368.082868 ... 417.059954 465.939086 398.551605 415.755174 381.761003 358.105707 366.840350 388.061625 377.001729 428.925348 WikiPathways_2024_Mouse|Ethanol Metabolism Resulting In Production Of ROS By CYP2E1 WP4265 113.749540 101.295690 109.330287 121.874276 111.233742 109.177887 107.894384 111.772260 119.100243 102.938040 ... 131.383434 136.281258 114.898870 133.223127 129.697425 132.973007 146.018403 127.484857 140.771557 127.940232 WikiPathways_2024_Mouse|Dysregulated miRNA Targeting In Insulin PI3K AKT Signaling WP3855 1655.286617 1734.465629 1942.802883 2121.994994 1514.036927 1446.445607 1465.712580 1562.861137 1719.188585 1541.025573 ... 1104.890794 1080.427281 778.902379 867.987162 973.467355 900.952491 750.172256 1086.581176 957.659905 1015.024726 WikiPathways_2024_Mouse|Eicosanoid Metabolism Via Cytochrome P450 Monooxygenases WP4349 62.560816 66.777037 63.632255 77.840835 58.952869 51.624316 56.089824 63.458400 66.738184 43.910045 ... 116.881632 109.360266 68.623759 61.301597 35.956575 35.849966 32.869851 27.814496 20.568147 20.558527 ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... WikiPathways_2024_Mouse|Methylation WP1247 164.660978 136.050051 151.238752 155.545924 158.309022 154.096267 178.346881 156.465190 137.400929 160.336570 ... 180.398816 196.751127 189.291494 198.890341 195.542493 204.942789 203.801581 179.038896 169.597698 190.460073 WikiPathways_2024_Mouse|Mapk Cascade WP251 163.223222 192.095731 210.604462 239.559565 160.508571 136.592661 136.760664 141.328642 183.350610 156.648976 ... 117.324887 127.582100 109.467965 111.969718 137.194178 133.086574 130.949927 110.283257 120.727764 141.378118 WikiPathways_2024_Mouse|Apoptosis WP1254 170.445033 173.657262 188.031175 188.837177 167.464920 173.892344 174.081430 180.186591 177.854008 163.986527 ... 185.438451 184.345808 191.761522 181.529209 193.773616 183.360052 175.365111 183.488964 201.379108 174.100468 WikiPathways_2024_Mouse|GPCRs Other WP41 63.476140 69.601460 70.554725 77.226448 66.530468 70.053805 70.197655 70.597880 63.505211 62.835935 ... 65.254190 61.636557 66.936162 63.214502 66.958863 65.755171 70.399818 61.779627 67.873685 65.249083 WikiPathways_2024_Mouse|TCA Cycle WP434 1862.569874 2055.606728 1849.449094 2051.558088 1773.589228 1690.053716 1500.226296 1738.701911 2029.226166 1690.742833 ... 1122.070373 1234.893288 964.260396 1327.438800 1041.887581 963.525298 935.695009 1158.208628 988.209204 1029.813694 <p>188 rows \u00d7 101 columns</p> <pre><code>%autoreload\nterm = 'WikiPathways_2024_Mouse|TCA Cycle WP434'\nobs_id = 'GSM334850'\nfig = obj.pl_running_sum('KS-ES', term, obs_id)\nfig\n</code></pre> <pre><code>%autoreload\nterm = 'WikiPathways_2024_Mouse|TCA Cycle WP434'\nobs_id = 'GSM334850'\nfig = obj.pl_running_sum('KS-ESD', term, obs_id)\nfig\n</code></pre> <pre><code>%autoreload\nterm = 'WikiPathways_2024_Mouse|TCA Cycle WP434'\nobs_id = 'GSM334850'\nfig = obj.pl_running_sum('RC-AUC', term, obs_id)\nfig\n</code></pre> <pre><code>%autoreload\nterm = 'WikiPathways_2024_Mouse|TCA Cycle WP434'\nobs_id = 'GSM334850'\nfig = obj.pl_running_sum('RC-nAUC', term, obs_id)\nfig\n</code></pre> <pre><code>%autoreload\nterm = 'WikiPathways_2024_Mouse|TCA Cycle WP434'\nobs_id = 'GSM334850'\nfig = obj.pl_running_sum('nRC-AUC', term, obs_id)\nfig\n</code></pre>"},{"location":"tutorial/gene-obs_prerank_enrich/#obs_prerank_enrich-enrichment-gene-list-with-rank-scores-for-observations","title":"<code>obs_prerank_enrich()</code> Enrichment: Gene List with Rank Scores for Observations","text":""},{"location":"tutorial/gene-obs_prerank_enrich/#step-1-prepare-rank_df","title":"Step 1: Prepare <code>rank_df</code>","text":"<p>Begin by preparing a list of genes along with their preranked scores (e.g., gene expression). Store this information in a DataFrame called <code>rank_df</code>.</p> <ul> <li>The index of <code>rank_df</code> should be the gene symbols.</li> <li>The columns of <code>rank_df</code> should correspond to one observation ID (e.g., sample or cell identifier).</li> </ul> <p>This format allows <code>obs_prerank_enrich()</code> to perform enrichment analysis using observation-level ranked gene-level statistics.</p>"},{"location":"tutorial/gene-obs_prerank_enrich/#step-2-preparing-gene-set-libraries","title":"Step 2: Preparing Gene Set Libraries","text":"<p>There are several ways to prepare gene set libraries for use in GREA:</p>"},{"location":"tutorial/gene-obs_prerank_enrich/#option-1-use-built-in-libraries","title":"Option 1: Use Built-in Libraries","text":"<p>Simply specify the <code>libraries</code> you're interested in as a list. For example:</p> <pre><code>libraries = ['KEGG_2019_Mouse', 'WikiPathways_2024_Mouse']\n</code></pre> <p>You can use the <code>grea.library.list_libraries()</code> function to view all available pathway libraries included in GREA.</p>"},{"location":"tutorial/gene-obs_prerank_enrich/#option-2-load-from-gmt-file","title":"Option 2: Load from GMT File","text":"<p>You can load external gene set libraries from <code>.gmt</code> files using:</p> <pre><code>libraries = read_gmt('your_library_file.gmt')\n</code></pre>"},{"location":"tutorial/gene-obs_prerank_enrich/#option-3-define-a-custom-library","title":"Option 3: Define a Custom Library","text":"<p>Create your own gene set library using a Python dictionary, where each key is a pathway name and the corresponding value is a list of genes:</p> <pre><code>libraries = {\n    'term1': ['A2ml1', 'A1cf'],\n    'term2': ['A3galt2', 'A4galt']\n}\n</code></pre>"},{"location":"tutorial/gene-obs_prerank_enrich/#step-3-run-enrichment","title":"Step 3: Run Enrichment","text":"<p>To perform enrichment analysis, call the <code>grea.obs_prerank_enrich(rank_df, libraries)</code> function.  The observation-level enrichment do not estimate the p-value for efficiency.</p> <p>The function returns a GREA object containing all enrichment results, including enrichment scores and statistical significance for each library term.</p>"},{"location":"tutorial/gene-obs_prerank_enrich/#step-4-check-enrichment-results","title":"Step 4: Check Enrichment Results","text":"<p>The <code>GREA</code> object stores all enrichment results, including enrichment scores and statistical significance for each library term. GREA supports three types of enrichment scores, each reflecting a different scoring strategy:</p> <ul> <li><code>'KS-ES'</code>: Kolmogorov\u2013Smirnov-based Enrichment Score, capturing the peak deviation between hit and miss distributions.</li> <li><code>'KS-ESD'</code>: KS-based enrichment Score Difference, the sum of the maximum positive and negative deviations from the running score.</li> <li><code>'RC-AUC'</code>: Area Under the Recovery Curve, summarizing early enrichment of target genes along the ranking.</li> <li><code>'RC-nAUC'</code>: The normalized Area Under the Recovery Curve, summarizing early enrichment of target genes along the ranking.</li> <li><code>'nRC-AUC'</code>: Area Under the normalized Recovery Curve, summarizing early enrichment of target genes along the ranking, ranges from 0 to 1.</li> </ul> <p>You can select the appropriate metric depending on your analysis goal or data characteristics.</p> <p>To retrieve the enrichment results as a long DataFrame, use the <code>get_enrich_results(metric)</code> function, as a wide DataFrame, use the <code>get_enrich_score(metric)</code>.</p>"},{"location":"tutorial/gene-obs_prerank_enrich/#step-5-visualize-enrichment-results","title":"Step 5: Visualize Enrichment Results","text":"<p>To visualize the enrichment results, use the <code>pl_running_sum(metric, term, obs_id)</code> function by specifying the desired metric, term, and observation ID.</p>"},{"location":"tutorial/gene-pheno_prerank_enrich/","title":"Phenotype-level prerank enrichment for genes","text":"<pre><code>%load_ext autoreload\n\nimport pandas as pd\nrank_df = pd.read_csv(\"grea/db/ageing_muscle_gtex.tsv\", index_col=0)\nrank_df.columns = ['Case vs. Control']\nrank_df.head()\n</code></pre> <pre>\n<code>The autoreload extension is already loaded. To reload it, use:\n  %reload_ext autoreload\n</code>\n</pre> Case vs. Control 0 ADO -7.833439 CHUK -7.800920 GOLGA4 -7.787221 EIF3J -7.716298 GID4 -7.551146 <pre><code>%autoreload\nfrom grea.library import list_libraries\n\nprint(list_libraries())\n</code></pre> <pre>\n<code>['GeneSigDB', 'Enrichr_Submissions_TF-Gene_Coocurrence', 'SysMyo_Muscle_Gene_Sets', 'WikiPathway_2021_Human', 'HomoloGene', 'WikiPathways_2013', 'PFOCR_Pathways_2023', 'OMIM_Disease', 'Data_Acquisition_Method_Most_Popular_Genes', 'NIBR_Jensen_DISEASES_Curated_2025', 'Cancer_Cell_Line_Encyclopedia', 'WikiPathways_2016', 'WikiPathways_2015', 'RNAseq_Automatic_GEO_Signatures_Human_Up', 'Human_Gene_Atlas', 'KOMP2_Mouse_Phenotypes_2022', 'MoTrPAC_2023', 'Kinase_Perturbations_from_GEO_down', 'Disease_Signatures_from_GEO_down_2014', 'Disease_Perturbations_from_GEO_up', 'Old_CMAP_down', 'MCF7_Perturbations_from_GEO_up', 'NIH_Funded_PIs_2017_GeneRIF_ARCHS4_Predictions', 'DepMap_WG_CRISPR_Screens_Sanger_CellLines_2019', 'PPI_Hub_Proteins', 'Disease_Signatures_from_GEO_up_2014', 'GTEx_Tissue_Expression_Up', 'NIBR_DRUGseq_2025_down', 'L1000_Kinase_and_GPCR_Perturbations_up', 'ARCHS4_Cell-lines', 'VirusMINT', 'KEGG_2019_Human', 'ARCHS4_Tissues', 'MGI_Mammalian_Phenotype_Level_4', 'The_Kinase_Library_2024', 'The_Kinase_Library_2023', 'MGI_Mammalian_Phenotype_Level_3', 'InterPro_Domains_2019', 'WikiPathways_2024_Mouse', 'DRUGseq_2025_up', 'KEGG_2015', 'MSigDB_Computational', 'KEGG_2013', 'TF-LOF_Expression_from_GEO', 'GWAS_Catalog_2019', 'KEGG_2016', 'NCI-Nature_2015', 'NCI-Nature_2016', 'CCLE_Proteomics_2020', 'PheWeb_2019', 'GeDiPNet_2023', 'RNA-Seq_Disease_Gene_and_Drug_Signatures_from_GEO', 'LINCS_L1000_Chem_Pert_down', 'Old_CMAP_up', 'LINCS_L1000_Ligand_Perturbations_down', 'Enrichr_Users_Contributed_Lists_2020', 'NIH_Funded_PIs_2017_Human_GeneRIF', 'Jensen_TISSUES', 'Azimuth_Cell_Types_2021', 'DisGeNET', 'Panther_2016', 'LINCS_L1000_Ligand_Perturbations_up', 'Rare_Diseases_AutoRIF_Gene_Lists', 'Achilles_fitness_increase', 'TargetScan_microRNA', 'Panther_2015', 'WikiPathways_2019_Mouse', 'ARCHS4_TFs_Coexp', 'LINCS_L1000_Chem_Pert_up', 'MSigDB_Oncogenic_Signatures', 'Gene_Perturbations_from_GEO_down', 'Table_Mining_of_CRISPR_Studies', 'Rare_Diseases_GeneRIF_Gene_Lists', 'Ligand_Perturbations_from_GEO_down', 'SILAC_Phosphoproteomics', 'Ligand_Perturbations_from_GEO_up', 'Drug_Perturbations_from_GEO_up', 'SynGO_2022', 'MGI_Mammalian_Phenotype_Level_4_2024', 'SynGO_2024', 'Allen_Brain_Atlas_10x_scRNA_2021', 'MGI_Mammalian_Phenotype_Level_4_2021', 'ClinVar_2019', 'GWAS_Catalog_2023', 'MAGMA_Drugs_and_Diseases', 'KEA_2015', 'KEA_2013', 'Microbe_Perturbations_from_GEO_up', 'Chromosome_Location', 'COVID-19_Related_Gene_Sets_2021', 'MGI_Mammalian_Phenotype_Level_4_2019', 'DRUGseqr_2025_down', 'ARCHS4_IDG_Coexp', 'NIH_Funded_PIs_2017_AutoRIF_ARCHS4_Predictions', 'Jensen_DISEASES_Experimental_2025', 'lncHUB_lncRNA_Co-Expression', 'PerturbAtlas', 'DrugMatrix', 'Virus_Perturbations_from_GEO_down', 'huMAP', 'L1000_Kinase_and_GPCR_Perturbations_down', 'Elsevier_Pathway_Collection', 'NIH_Funded_PIs_2017_Human_AutoRIF', 'Diabetes_Perturbations_GEO_2022', 'ESCAPE', 'RNAseq_Automatic_GEO_Signatures_Mouse_Down', 'UK_Biobank_GWAS_v1', 'Aging_Perturbations_from_GEO_up', 'Human_Phenotype_Ontology', 'Jensen_DISEASES_Curated_2025', 'Proteomics_Drug_Atlas_2023', 'dbGaP', 'SubCell_BarCode', 'Transcription_Factor_PPIs', 'GO_Cellular_Component_2017b', 'HuBMAP_ASCTplusB_augmented_2022', 'MSigDB_Hallmark_2020', 'GlyGen_Glycosylated_Proteins_2022', 'MAGNET_2023', 'CellMarker_2024', 'BioPlanet_2019', 'HDSigDB_Human_2021', 'GTEx_Tissues_V8_2023', 'GTEx_Tissue_Expression_Down', 'Metabolomics_Workbench_Metabolites_2022', 'Tissue_Protein_Expression_from_Human_Proteome_Map', 'Epigenomics_Roadmap_HM_ChIP-seq', 'PhenGenI_Association_2021', 'MCF7_Perturbations_from_GEO_down', 'ProteomicsDB_2020', 'Virus-Host_PPI_P-HIPSTer_2020', 'OMIM_Expanded', 'Reactome_2022', 'Genes_Associated_with_NIH_Grants', 'CellMarker_Augmented_2021', 'ENCODE_and_ChEA_Consensus_TFs_from_ChIP-X', 'HDSigDB_Mouse_2021', 'Jensen_COMPARTMENTS', 'ChEA_2015', 'ChEA_2016', 'KEGG_2019_Mouse', 'ChEA_2022', 'LINCS_L1000_Chem_Pert_Consensus_Sigs', 'Drug_Perturbations_from_GEO_2014', 'TargetScan_microRNA_2017', 'KEGG_2021_Mouse', 'Allen_Brain_Atlas_down', 'WikiPathways_2019_Human', 'Reactome_2013', 'BioCarta_2013', 'Rummagene_transcription_factors', 'Gene_Perturbations_from_GEO_up', 'GO_Cellular_Component_2015', 'Rummagene-signatures', 'GO_Cellular_Component_2013', 'BioCarta_2016', 'NIBR_Jensen_DISEASES_Experimental_2025', 'BioCarta_2015', 'Reactome_2015', 'Reactome_2016', 'GO_Cellular_Component_2018', 'GO_Cellular_Component_2017', 'GO_Cellular_Component_2023', 'GO_Cellular_Component_2021', 'WikiPathway_2021_Mouse', 'ENCODE_TF_ChIP-seq_2015', 'ENCODE_TF_ChIP-seq_2014', 'RNAseq_Automatic_GEO_Signatures_Mouse_Up', 'GO_Molecular_Function_2017b', 'DRUGseq_2025_down', 'FANTOM6_lncRNA_KD_DEGs', 'MGI_Mammalian_Phenotype_2013', 'GO_Cellular_Component_2025', 'HMS_LINCS_KinomeScan', 'NCI-60_Cancer_Cell_Lines', 'Azimuth_2023', 'MGI_Mammalian_Phenotype_2017', 'Rare_Diseases_GeneRIF_ARCHS4_Predictions', 'Virus_Perturbations_from_GEO_up', 'PFOCR_Pathways', 'IDG_Drug_Targets_2022', 'Enrichr_Libraries_Most_Popular_Genes', 'Orphanet_Augmented_2021', 'NIBR_DRUGseq_2025_up', 'GO_Biological_Process_2021', 'TRANSFAC_and_JASPAR_PWMs', 'Reactome_Pathways_2024', 'GO_Biological_Process_2023', 'Rare_Diseases_AutoRIF_ARCHS4_Predictions', 'COVID-19_Related_Gene_Sets', 'Kinase_Perturbations_from_GEO_up', 'Descartes_Cell_Types_and_Tissue_2021', 'Tabula_Muris', 'Tabula_Sapiens', 'GO_Biological_Process_2025', 'TF_Perturbations_Followed_by_Expression', 'Rummagene_kinases', 'GTEx_Aging_Signatures_2021', 'WikiPathways_2024_Human', 'Tissue_Protein_Expression_from_ProteomicsDB', 'DGIdb_Drug_Targets_2024', 'Serine_Threonine_Kinome_Atlas_2023', 'Aging_Perturbations_from_GEO_down', 'DepMap_CRISPR_GeneDependency_CellLines_2023', 'GO_Biological_Process_2013', 'GO_Biological_Process_2017b', 'GO_Biological_Process_2018', 'CORUM', 'GO_Biological_Process_2015', 'Phosphatase_Substrates_from_DEPOD', 'BioPlex_2017', 'TRRUST_Transcription_Factors_2019', 'GO_Biological_Process_2017', 'Pfam_InterPro_Domains', 'HuBMAP_ASCT_plus_B_augmented_w_RNAseq_Coexpression', 'Pfam_Domains_2019', 'WikiPathway_2023_Human', 'Allen_Brain_Atlas_up', 'Genome_Browser_PWMs', 'NURSA_Human_Endogenous_Complexome', 'HumanCyc_2015', 'HumanCyc_2016', 'Rummagene_signatures', 'Chromosome_Location_hg19', 'Mouse_Gene_Atlas', 'ChEA_2013', 'miRTarBase_2017', 'GO_Molecular_Function_2023', 'Jensen_DISEASES', 'RNAseq_Automatic_GEO_Signatures_Human_Down', 'GO_Molecular_Function_2025', 'Rummagene-transcription-factors', 'ARCHS4_Kinases_Coexp', 'Microbe_Perturbations_from_GEO_down', 'DRUGseqr_2025_up', 'PanglaoDB_Augmented_2021', 'ENCODE_Histone_Modifications_2013', 'ENCODE_Histone_Modifications_2015', 'Achilles_fitness_decrease', 'DSigDB', 'DepMap_WG_CRISPR_Screens_Broad_CellLines_2019', 'Disease_Perturbations_from_GEO_down', 'Drug_Perturbations_from_GEO_down', 'GO_Molecular_Function_2021', 'GO_Molecular_Function_2017', 'GO_Molecular_Function_2018', 'Mitchell_Proteomics_Drug_Atlas_2023', 'GO_Molecular_Function_2013', 'GO_Molecular_Function_2015', 'Rummagene-kinases', 'TG_GATES_2020', 'KEGG_2021_Human', 'HMDB_Metabolites', 'LINCS_L1000_CRISPR_KO_Consensus_Sigs']\n</code>\n</pre> <pre><code>%autoreload\n\nfrom grea import grea\nlibraries = ['MSigDB_Hallmark_2020']\nn_perm = 10\nprob_method = 'perm'\nobj = grea.pheno_prerank_enrich(rank_df, libraries,n_perm=n_perm, prob_method=prob_method)\nobj\n</code></pre> <pre>\n<code>---Finished: Load MSigDB_Hallmark_2020 with 50 terms.\nLow numer of permutations can lead to inaccurate p-value estimation. Symmetric Gamma distribution enabled to increase accuracy.\n---WARMING: 99.0% of entries has zero overlap ratio.\nPlease check the consistency (upper/lower case) of signature names in rand_df and libraries.\nCurrent rand_df sig name: ADO, library sig name: MARCKS\nCurrent setting - sig_upper=True\n</code>\n</pre> <pre>\n<code>&lt;grea.grea._GREA at 0x270b0883020&gt;</code>\n</pre> <pre><code>%autoreload\n\ndf = obj.get_enrich_results(metric='KS-ES')\ndf.head()\n</code></pre> Term Obs KS-ES Prob_method KS-ES_pval N_lead_sigs Lead_sigs KS-ES_fdr KS-ES_sidak 29 MSigDB_Hallmark_2020|Epithelial Mesenchymal Tr... Case vs. Control 0.586199 perm 0.01 104 HTRA1;IL15;MGP;PCOLCE;BGN;CCN1;CTHRC1;VIM;IGFB... 0.013889 0.394994 21 MSigDB_Hallmark_2020|Hedgehog Signaling Case vs. Control 0.568802 perm 0.01 20 MYH9;PML;THY1;NRP2;ETS2;CRMP1;L1CAM;OPHN1;ACHE... 0.013889 0.394994 39 MSigDB_Hallmark_2020|Angiogenesis Case vs. Control 0.563786 perm 0.01 19 LUM;VAV2;TIMP1;JAG2;STC1;APP;TNFRSF21;VCAN;POS... 0.013889 0.394994 41 MSigDB_Hallmark_2020|Coagulation Case vs. Control 0.530405 perm 0.01 39 MST1;CAPN2;HTRA1;PLAT;A2M;C3;GSN;CRIP2;CFD;C2;... 0.013889 0.394994 49 MSigDB_Hallmark_2020|Pancreas Beta Cells Case vs. Control 0.504512 perm 0.01 7 STXBP1;ABCC8;LMO2;SRP14;ELP4;DPP4;PAK3 0.013889 0.394994 <pre><code>%autoreload\n\ndf = obj.get_enrich_results(metric='KS-ESD')\ndf.head()\n</code></pre> Term Obs KS-ESD Prob_method KS-ESD_pval N_lead_sigs Lead_sigs KS-ESD_fdr KS-ESD_sidak 29 MSigDB_Hallmark_2020|Epithelial Mesenchymal Tr... Case vs. Control 0.582130 perm 0.01 104 HTRA1;IL15;MGP;PCOLCE;BGN;CCN1;CTHRC1;VIM;IGFB... 0.012821 0.394994 21 MSigDB_Hallmark_2020|Hedgehog Signaling Case vs. Control 0.558907 perm 0.01 20 MYH9;PML;THY1;NRP2;ETS2;CRMP1;L1CAM;OPHN1;ACHE... 0.012821 0.394994 39 MSigDB_Hallmark_2020|Angiogenesis Case vs. Control 0.541065 perm 0.01 19 LUM;VAV2;TIMP1;JAG2;STC1;APP;TNFRSF21;VCAN;POS... 0.012821 0.394994 41 MSigDB_Hallmark_2020|Coagulation Case vs. Control 0.529377 perm 0.01 39 MST1;CAPN2;HTRA1;PLAT;A2M;C3;GSN;CRIP2;CFD;C2;... 0.012821 0.394994 17 MSigDB_Hallmark_2020|Interferon Alpha Response Case vs. Control 0.476122 perm 0.01 52 CD74;IL15;MOV10;LGALS3BP;IFITM1;DHX58;UBA7;IFI... 0.012821 0.394994 <pre><code>%autoreload\n\ndf = obj.get_enrich_results(metric='RC-AUC')\ndf.head()\n</code></pre> Term Obs RC-AUC Prob_method RC-AUC_pval RC-AUC_fdr RC-AUC_sidak 29 MSigDB_Hallmark_2020|Epithelial Mesenchymal Tr... Case vs. Control 364.765125 perm 0.01 0.033333 0.394994 19 MSigDB_Hallmark_2020|Apical Junction Case vs. Control 290.515232 perm 0.01 0.033333 0.394994 18 MSigDB_Hallmark_2020|Interferon Gamma Response Case vs. Control 279.576303 perm 0.01 0.033333 0.394994 15 MSigDB_Hallmark_2020|Myogenesis Case vs. Control 252.340210 perm 0.01 0.033333 0.394994 22 MSigDB_Hallmark_2020|Complement Case vs. Control 229.770458 perm 0.01 0.033333 0.394994 <pre><code>%autoreload\n\ndf = obj.get_enrich_results(metric='RC-nAUC')\ndf.head()\n</code></pre> Term Obs RC-nAUC Prob_method RC-nAUC_pval RC-nAUC_fdr RC-nAUC_sidak 29 MSigDB_Hallmark_2020|Epithelial Mesenchymal Tr... Case vs. Control 1.961103 perm 0.01 0.033333 0.394994 41 MSigDB_Hallmark_2020|Coagulation Case vs. Control 1.929050 perm 0.01 0.033333 0.394994 21 MSigDB_Hallmark_2020|Hedgehog Signaling Case vs. Control 1.777970 perm 0.01 0.033333 0.394994 17 MSigDB_Hallmark_2020|Interferon Alpha Response Case vs. Control 1.664051 perm 0.01 0.033333 0.394994 19 MSigDB_Hallmark_2020|Apical Junction Case vs. Control 1.660087 perm 0.01 0.033333 0.394994 <pre><code>%autoreload\n\ndf = obj.get_enrich_results(metric='nRC-AUC')\ndf.head()\n</code></pre> Term Obs nRC-AUC Prob_method nRC-AUC_pval nRC-AUC_fdr nRC-AUC_sidak 29 MSigDB_Hallmark_2020|Epithelial Mesenchymal Tr... Case vs. Control 0.828970 perm 0.01 0.021739 0.394994 21 MSigDB_Hallmark_2020|Hedgehog Signaling Case vs. Control 0.818242 perm 0.01 0.021739 0.394994 41 MSigDB_Hallmark_2020|Coagulation Case vs. Control 0.806329 perm 0.01 0.021739 0.394994 39 MSigDB_Hallmark_2020|Angiogenesis Case vs. Control 0.785538 perm 0.01 0.021739 0.394994 17 MSigDB_Hallmark_2020|Interferon Alpha Response Case vs. Control 0.758177 perm 0.01 0.021739 0.394994 <pre><code>%autoreload\nterm = 'MSigDB_Hallmark_2020|Hedgehog Signaling'\npheno_id = 'Case vs. Control'\nfig = obj.pl_running_sum('KS-ES', term, pheno_id)\nfig\n</code></pre> <pre><code>%autoreload\nterm = 'MSigDB_Hallmark_2020|Hedgehog Signaling'\npheno_id = 'Case vs. Control'\nfig = obj.pl_running_sum('KS-ESD', term, pheno_id)\nfig\n</code></pre> <pre><code>%autoreload\nterm = 'MSigDB_Hallmark_2020|Hedgehog Signaling'\npheno_id = 'Case vs. Control'\nfig = obj.pl_running_sum('RC-AUC', term, pheno_id)\nfig\n</code></pre> <pre><code>%autoreload\nterm = 'MSigDB_Hallmark_2020|Hedgehog Signaling'\npheno_id = 'Case vs. Control'\nfig = obj.pl_running_sum('RC-nAUC', term, pheno_id)\nfig\n</code></pre> <pre><code>%autoreload\nterm = 'MSigDB_Hallmark_2020|Hedgehog Signaling'\npheno_id = 'Case vs. Control'\nfig = obj.pl_running_sum('nRC-AUC', term, pheno_id)\nfig\n</code></pre>"},{"location":"tutorial/gene-pheno_prerank_enrich/#pheno_prerank_enrich-enrichment-gene-list-with-rank-scores-for-phenotypes","title":"<code>pheno_prerank_enrich()</code> Enrichment: Gene List with Rank Scores for Phenotypes","text":""},{"location":"tutorial/gene-pheno_prerank_enrich/#step-1-prepare-rank_df","title":"Step 1: Prepare <code>rank_df</code>","text":"<p>Begin by preparing a list of genes along with their preranked scores. Store this information in a DataFrame called <code>rank_df</code>.</p> <ul> <li>The index of <code>rank_df</code> should be the gene symbols.</li> <li>The columns of <code>rank_df</code> should correspond to one target phenotype (e.g., Case vs. Control).</li> </ul> <p>This format allows <code>pheno_prerank_enrich</code> to perform enrichment analysis using phenotype-level ranked gene-level statistics.</p>"},{"location":"tutorial/gene-pheno_prerank_enrich/#step-2-preparing-gene-set-libraries","title":"Step 2: Preparing Gene Set Libraries","text":"<p>There are several ways to prepare gene set libraries for use in GREA:</p>"},{"location":"tutorial/gene-pheno_prerank_enrich/#option-1-use-built-in-libraries","title":"Option 1: Use Built-in Libraries","text":"<p>Simply specify the <code>libraries</code> you're interested in as a list. For example:</p> <pre><code>libraries = ['KEGG_2021_Human', 'MSigDB_Hallmark_2020']\n</code></pre> <p>You can use the <code>grea.library.list_libraries()</code> function to view all available pathway libraries included in GREA.</p>"},{"location":"tutorial/gene-pheno_prerank_enrich/#option-2-load-from-gmt-file","title":"Option 2: Load from GMT File","text":"<p>You can load external gene set libraries from <code>.gmt</code> files using:</p> <pre><code>libraries = read_gmt('your_library_file.gmt')\n</code></pre>"},{"location":"tutorial/gene-pheno_prerank_enrich/#option-3-define-a-custom-library","title":"Option 3: Define a Custom Library","text":"<p>Create your own gene set library using a Python dictionary, where each key is a pathway name and the corresponding value is a list of genes:</p> <pre><code>libraries = {\n    'term1': ['GOLGA4', 'GID4'],\n    'term2': ['ADO', 'CHUK']\n}\n</code></pre>"},{"location":"tutorial/gene-pheno_prerank_enrich/#step-3-run-enrichment","title":"Step 3: Run Enrichment","text":"<p>To perform enrichment analysis, call the <code>grea.pheno_prerank_enrich(rank_df, libraries)</code> function. You can customize the analysis using the following arguments:</p> <ul> <li><code>prob_method</code>: Method for p-value calculation. Currently supports <code>'perm'</code> for permutation-based testing.</li> <li><code>n_perm</code>: Number of permutations to use for estimating the null distribution.</li> </ul> <p>The function returns a GREA object containing all enrichment results, including enrichment scores and statistical significance for each library term.</p>"},{"location":"tutorial/gene-pheno_prerank_enrich/#step-4-check-enrichment-results","title":"Step 4: Check Enrichment Results","text":"<p>The <code>GREA</code> object stores all enrichment results, including enrichment scores and statistical significance for each library term. GREA supports three types of enrichment scores, each reflecting a different scoring strategy:</p> <ul> <li><code>'KS-ES'</code>: Kolmogorov\u2013Smirnov-based Enrichment Score, capturing the peak deviation between hit and miss distributions.</li> <li><code>'KS-ESD'</code>: KS-based enrichment Score Difference, the sum of the maximum positive and negative deviations from the running score.</li> <li><code>'RC-AUC'</code>: Area Under the Recovery Curve, summarizing early enrichment of target genes along the ranking.</li> <li><code>'RC-nAUC'</code>: The normalized Area Under the Recovery Curve, summarizing early enrichment of target genes along the ranking.</li> <li><code>'nRC-AUC'</code>: Area Under the normalized Recovery Curve, summarizing early enrichment of target genes along the ranking, ranges from 0 to 1.</li> </ul> <p>You can select the appropriate metric depending on your analysis goal or data characteristics.</p> <p>To retrieve the enrichment results as a long DataFrame, use the <code>get_enrich_results(metric)</code> function.</p>"},{"location":"tutorial/gene-pheno_prerank_enrich/#step-5-visualize-enrichment-results","title":"Step 5: Visualize Enrichment Results","text":"<p>To visualize the enrichment results, use the <code>pl_running_sum(metric, term, pheno_id)</code> function by specifying the desired metric, term, and target phenotype.</p>"},{"location":"tutorial/interaction-obs_prerank_enrich/","title":"Observation-level prerank enrichment for gene interactions","text":"<pre><code>%load_ext autoreload\n\nimport pandas as pd\nrank_df = pd.read_csv(\"grea/db/GSE30550_H3N2_CRISGI_score.csv\", index_col=0)\nrank_df.head()\n</code></pre> s1 -24h s1 0h s1 5h s1 12h s1 21h s1 29h s1 36h s1 45h s1 53h s1 60h s1 69h s1 77h s1 84h s1 93h s1 101h s1 108h symbol A1CF_APOB 3.380000e-07 5.360000e-07 1.400000e-07 3.580000e-07 4.370000e-07 0.000827 5.470000e-07 1.180000e-06 1.690000e-06 5.550000e-08 4.020000e-07 1.380000e-07 7.330000e-07 7.190000e-07 8.240000e-07 6.280000e-08 A2M_ALB 9.190000e-09 1.340000e-08 1.240000e-08 4.920000e-09 1.850000e-08 0.000256 2.620000e-08 3.010000e-09 1.200000e-09 3.910000e-08 5.990000e-10 1.130000e-08 6.510000e-09 2.170000e-08 9.850000e-10 1.410000e-08 A2M_AMBP 3.110000e-08 3.580000e-07 3.510000e-08 6.790000e-08 2.780000e-08 0.000291 3.100000e-07 6.050000e-08 1.020000e-07 1.080000e-07 3.350000e-08 1.470000e-08 8.880000e-09 3.730000e-08 4.060000e-09 2.910000e-09 A2M_APOA1 2.080000e-07 1.510000e-08 3.820000e-07 1.550000e-08 4.930000e-07 0.001086 5.000000e-07 1.870000e-07 7.920000e-08 6.450000e-08 9.930000e-08 2.760000e-08 1.480000e-07 2.140000e-08 4.700000e-08 2.800000e-07 A2M_APP 2.370000e-07 1.240000e-07 7.810000e-08 2.610000e-07 1.430000e-07 0.000393 4.270000e-07 1.020000e-07 2.600000e-07 5.460000e-08 1.790000e-09 1.070000e-08 2.170000e-08 6.810000e-09 1.040000e-07 2.370000e-07 <pre><code>%autoreload\nfrom grea.library import list_libraries\n\nprint(list_libraries())\n</code></pre> <pre>\n<code>['GeneSigDB', 'Enrichr_Submissions_TF-Gene_Coocurrence', 'SysMyo_Muscle_Gene_Sets', 'WikiPathway_2021_Human', 'HomoloGene', 'WikiPathways_2013', 'PFOCR_Pathways_2023', 'OMIM_Disease', 'Data_Acquisition_Method_Most_Popular_Genes', 'NIBR_Jensen_DISEASES_Curated_2025', 'Cancer_Cell_Line_Encyclopedia', 'WikiPathways_2016', 'WikiPathways_2015', 'RNAseq_Automatic_GEO_Signatures_Human_Up', 'Human_Gene_Atlas', 'KOMP2_Mouse_Phenotypes_2022', 'MoTrPAC_2023', 'Kinase_Perturbations_from_GEO_down', 'Disease_Signatures_from_GEO_down_2014', 'Disease_Perturbations_from_GEO_up', 'Old_CMAP_down', 'MCF7_Perturbations_from_GEO_up', 'NIH_Funded_PIs_2017_GeneRIF_ARCHS4_Predictions', 'DepMap_WG_CRISPR_Screens_Sanger_CellLines_2019', 'PPI_Hub_Proteins', 'Disease_Signatures_from_GEO_up_2014', 'GTEx_Tissue_Expression_Up', 'NIBR_DRUGseq_2025_down', 'L1000_Kinase_and_GPCR_Perturbations_up', 'ARCHS4_Cell-lines', 'VirusMINT', 'KEGG_2019_Human', 'ARCHS4_Tissues', 'MGI_Mammalian_Phenotype_Level_4', 'The_Kinase_Library_2024', 'The_Kinase_Library_2023', 'MGI_Mammalian_Phenotype_Level_3', 'InterPro_Domains_2019', 'WikiPathways_2024_Mouse', 'DRUGseq_2025_up', 'KEGG_2015', 'MSigDB_Computational', 'KEGG_2013', 'TF-LOF_Expression_from_GEO', 'GWAS_Catalog_2019', 'KEGG_2016', 'NCI-Nature_2015', 'NCI-Nature_2016', 'CCLE_Proteomics_2020', 'PheWeb_2019', 'GeDiPNet_2023', 'RNA-Seq_Disease_Gene_and_Drug_Signatures_from_GEO', 'LINCS_L1000_Chem_Pert_down', 'Old_CMAP_up', 'LINCS_L1000_Ligand_Perturbations_down', 'Enrichr_Users_Contributed_Lists_2020', 'NIH_Funded_PIs_2017_Human_GeneRIF', 'Jensen_TISSUES', 'Azimuth_Cell_Types_2021', 'DisGeNET', 'Panther_2016', 'LINCS_L1000_Ligand_Perturbations_up', 'Rare_Diseases_AutoRIF_Gene_Lists', 'Achilles_fitness_increase', 'TargetScan_microRNA', 'Panther_2015', 'WikiPathways_2019_Mouse', 'ARCHS4_TFs_Coexp', 'LINCS_L1000_Chem_Pert_up', 'MSigDB_Oncogenic_Signatures', 'Gene_Perturbations_from_GEO_down', 'Table_Mining_of_CRISPR_Studies', 'Rare_Diseases_GeneRIF_Gene_Lists', 'Ligand_Perturbations_from_GEO_down', 'SILAC_Phosphoproteomics', 'Ligand_Perturbations_from_GEO_up', 'Drug_Perturbations_from_GEO_up', 'SynGO_2022', 'MGI_Mammalian_Phenotype_Level_4_2024', 'SynGO_2024', 'Allen_Brain_Atlas_10x_scRNA_2021', 'MGI_Mammalian_Phenotype_Level_4_2021', 'ClinVar_2019', 'GWAS_Catalog_2023', 'MAGMA_Drugs_and_Diseases', 'KEA_2015', 'KEA_2013', 'Microbe_Perturbations_from_GEO_up', 'Chromosome_Location', 'COVID-19_Related_Gene_Sets_2021', 'MGI_Mammalian_Phenotype_Level_4_2019', 'DRUGseqr_2025_down', 'ARCHS4_IDG_Coexp', 'NIH_Funded_PIs_2017_AutoRIF_ARCHS4_Predictions', 'Jensen_DISEASES_Experimental_2025', 'lncHUB_lncRNA_Co-Expression', 'PerturbAtlas', 'DrugMatrix', 'Virus_Perturbations_from_GEO_down', 'huMAP', 'L1000_Kinase_and_GPCR_Perturbations_down', 'Elsevier_Pathway_Collection', 'NIH_Funded_PIs_2017_Human_AutoRIF', 'Diabetes_Perturbations_GEO_2022', 'ESCAPE', 'RNAseq_Automatic_GEO_Signatures_Mouse_Down', 'UK_Biobank_GWAS_v1', 'Aging_Perturbations_from_GEO_up', 'Human_Phenotype_Ontology', 'Jensen_DISEASES_Curated_2025', 'Proteomics_Drug_Atlas_2023', 'dbGaP', 'SubCell_BarCode', 'Transcription_Factor_PPIs', 'GO_Cellular_Component_2017b', 'HuBMAP_ASCTplusB_augmented_2022', 'MSigDB_Hallmark_2020', 'GlyGen_Glycosylated_Proteins_2022', 'MAGNET_2023', 'CellMarker_2024', 'BioPlanet_2019', 'HDSigDB_Human_2021', 'GTEx_Tissues_V8_2023', 'GTEx_Tissue_Expression_Down', 'Metabolomics_Workbench_Metabolites_2022', 'Tissue_Protein_Expression_from_Human_Proteome_Map', 'Epigenomics_Roadmap_HM_ChIP-seq', 'PhenGenI_Association_2021', 'MCF7_Perturbations_from_GEO_down', 'ProteomicsDB_2020', 'Virus-Host_PPI_P-HIPSTer_2020', 'OMIM_Expanded', 'Reactome_2022', 'Genes_Associated_with_NIH_Grants', 'CellMarker_Augmented_2021', 'ENCODE_and_ChEA_Consensus_TFs_from_ChIP-X', 'HDSigDB_Mouse_2021', 'Jensen_COMPARTMENTS', 'ChEA_2015', 'ChEA_2016', 'KEGG_2019_Mouse', 'ChEA_2022', 'LINCS_L1000_Chem_Pert_Consensus_Sigs', 'Drug_Perturbations_from_GEO_2014', 'TargetScan_microRNA_2017', 'KEGG_2021_Mouse', 'Allen_Brain_Atlas_down', 'WikiPathways_2019_Human', 'Reactome_2013', 'BioCarta_2013', 'Rummagene_transcription_factors', 'Gene_Perturbations_from_GEO_up', 'GO_Cellular_Component_2015', 'Rummagene-signatures', 'GO_Cellular_Component_2013', 'BioCarta_2016', 'NIBR_Jensen_DISEASES_Experimental_2025', 'BioCarta_2015', 'Reactome_2015', 'Reactome_2016', 'GO_Cellular_Component_2018', 'GO_Cellular_Component_2017', 'GO_Cellular_Component_2023', 'GO_Cellular_Component_2021', 'WikiPathway_2021_Mouse', 'ENCODE_TF_ChIP-seq_2015', 'ENCODE_TF_ChIP-seq_2014', 'RNAseq_Automatic_GEO_Signatures_Mouse_Up', 'GO_Molecular_Function_2017b', 'DRUGseq_2025_down', 'FANTOM6_lncRNA_KD_DEGs', 'MGI_Mammalian_Phenotype_2013', 'GO_Cellular_Component_2025', 'HMS_LINCS_KinomeScan', 'NCI-60_Cancer_Cell_Lines', 'Azimuth_2023', 'MGI_Mammalian_Phenotype_2017', 'Rare_Diseases_GeneRIF_ARCHS4_Predictions', 'Virus_Perturbations_from_GEO_up', 'PFOCR_Pathways', 'IDG_Drug_Targets_2022', 'Enrichr_Libraries_Most_Popular_Genes', 'Orphanet_Augmented_2021', 'NIBR_DRUGseq_2025_up', 'GO_Biological_Process_2021', 'TRANSFAC_and_JASPAR_PWMs', 'Reactome_Pathways_2024', 'GO_Biological_Process_2023', 'Rare_Diseases_AutoRIF_ARCHS4_Predictions', 'COVID-19_Related_Gene_Sets', 'Kinase_Perturbations_from_GEO_up', 'Descartes_Cell_Types_and_Tissue_2021', 'Tabula_Muris', 'Tabula_Sapiens', 'GO_Biological_Process_2025', 'TF_Perturbations_Followed_by_Expression', 'Rummagene_kinases', 'GTEx_Aging_Signatures_2021', 'WikiPathways_2024_Human', 'Tissue_Protein_Expression_from_ProteomicsDB', 'DGIdb_Drug_Targets_2024', 'Serine_Threonine_Kinome_Atlas_2023', 'Aging_Perturbations_from_GEO_down', 'DepMap_CRISPR_GeneDependency_CellLines_2023', 'GO_Biological_Process_2013', 'GO_Biological_Process_2017b', 'GO_Biological_Process_2018', 'CORUM', 'GO_Biological_Process_2015', 'Phosphatase_Substrates_from_DEPOD', 'BioPlex_2017', 'TRRUST_Transcription_Factors_2019', 'GO_Biological_Process_2017', 'Pfam_InterPro_Domains', 'HuBMAP_ASCT_plus_B_augmented_w_RNAseq_Coexpression', 'Pfam_Domains_2019', 'WikiPathway_2023_Human', 'Allen_Brain_Atlas_up', 'Genome_Browser_PWMs', 'NURSA_Human_Endogenous_Complexome', 'HumanCyc_2015', 'HumanCyc_2016', 'Rummagene_signatures', 'Chromosome_Location_hg19', 'Mouse_Gene_Atlas', 'ChEA_2013', 'miRTarBase_2017', 'GO_Molecular_Function_2023', 'Jensen_DISEASES', 'RNAseq_Automatic_GEO_Signatures_Human_Down', 'GO_Molecular_Function_2025', 'Rummagene-transcription-factors', 'ARCHS4_Kinases_Coexp', 'Microbe_Perturbations_from_GEO_down', 'DRUGseqr_2025_up', 'PanglaoDB_Augmented_2021', 'ENCODE_Histone_Modifications_2013', 'ENCODE_Histone_Modifications_2015', 'Achilles_fitness_decrease', 'DSigDB', 'DepMap_WG_CRISPR_Screens_Broad_CellLines_2019', 'Disease_Perturbations_from_GEO_down', 'Drug_Perturbations_from_GEO_down', 'GO_Molecular_Function_2021', 'GO_Molecular_Function_2017', 'GO_Molecular_Function_2018', 'Mitchell_Proteomics_Drug_Atlas_2023', 'GO_Molecular_Function_2013', 'GO_Molecular_Function_2015', 'Rummagene-kinases', 'TG_GATES_2020', 'KEGG_2021_Human', 'HMDB_Metabolites', 'LINCS_L1000_CRISPR_KO_Consensus_Sigs']\n</code>\n</pre> <pre><code>%autoreload\n\nfrom grea import grea\nlibraries = ['KEGG_2021_Human']\nsig_sep = '_'\nobj = grea.obs_prerank_enrich(rank_df, libraries, sig_sep=sig_sep)\nobj\n</code></pre> <pre>\n<code>---Finished: Load KEGG_2021_Human with 320 terms.\n---WARMING: 97.0% of entries has zero overlap ratio.\n\n</code>\n</pre> <pre>\n<code>c:\\Users\\User\\Dropbox\\workspace\\GREA\\grea\\enrich_signal.py:295: RuntimeWarning: invalid value encountered in divide\n  obj.RC_nAUC = obj.RC_AUC/obj.n_hits\n</code>\n</pre> <pre>\n<code>&lt;grea.grea._GREA at 0x2071f7e79b0&gt;</code>\n</pre> <pre><code>%autoreload\n\ndf = obj.get_enrich_results(metric='KS-ES')\ndf.head()\n</code></pre> Term Obs KS-ES N_lead_sigs Lead_sigs 310 KEGG_2021_Human|Vitamin digestion and absorption s1 29h 0.959399 65 APOB_OLR1;APOB_FABP1;APOB_LDLR;APOA2_APOB;APOB... 220 KEGG_2021_Human|Porphyrin and chlorophyll meta... s1 12h 0.957048 27 ALAS2_FECH;FECH_PGRMC1;ALAS2_HMBS;ALAS2_DAO;AL... 109 KEGG_2021_Human|Glycine, serine and threonine ... s1 12h 0.956803 32 BPGM_ENO2;ALAS2_FECH;ALAS2_HMBS;ALAS2_DAO;ALAS... 220 KEGG_2021_Human|Porphyrin and chlorophyll meta... s1 21h 0.954358 25 ALAS2_FECH;AHSP_ALAS2;ALAS2_HMBS;ALAS2_GYPB;AL... 220 KEGG_2021_Human|Porphyrin and chlorophyll meta... s1 0h 0.952777 33 ALAS2_FECH;FECH_PGRMC1;ALAS2_GLRX5;ALAS2_HMBS;... <pre><code>%autoreload\n\ndf = obj.get_enrich_score(metric='KS-ES')\ndf.head()\n</code></pre> s1 -24h s1 0h s1 5h s1 12h s1 21h s1 29h s1 36h s1 45h s1 53h s1 60h s1 69h s1 77h s1 84h s1 93h s1 101h s1 108h KEGG_2021_Human|ABC transporters 0.534848 0.448287 0.249589 0.455413 0.287627 0.495515 0.256987 -0.162640 -0.301806 -0.272147 -0.229137 0.274393 -0.358780 -0.269382 -0.186018 -0.351217 KEGG_2021_Human|AGE-RAGE signaling pathway in diabetic complications 0.333807 0.225845 0.449939 0.289909 -0.198786 0.120718 0.868396 0.819802 0.823229 0.677201 0.290928 0.344129 0.196258 0.487515 0.454684 -0.197361 KEGG_2021_Human|AMPK signaling pathway 0.194808 0.274043 0.177802 0.140077 -0.205039 0.146201 -0.042705 -0.105274 -0.112521 -0.172765 0.219105 0.203368 0.203952 0.150618 0.191480 -0.268288 KEGG_2021_Human|Acute myeloid leukemia 0.146511 0.172203 0.284749 0.244221 -0.222500 -0.229949 0.319346 0.263699 0.261932 0.270608 0.326906 0.328356 0.287975 0.297143 0.168369 -0.154065 KEGG_2021_Human|Adherens junction -0.140491 -0.233823 0.106506 -0.140749 -0.345522 -0.248893 0.128135 -0.100212 -0.279370 -0.289267 0.122337 0.345925 -0.217721 -0.160355 -0.351508 -0.331649 <pre><code>%autoreload\n\ndf = obj.get_enrich_results(metric='KS-ESD')\ndf.head()\n</code></pre> Term Obs KS-ESD N_lead_sigs Lead_sigs 310 KEGG_2021_Human|Vitamin digestion and absorption s1 29h 0.959144 65 APOB_OLR1;APOB_FABP1;APOB_LDLR;APOA2_APOB;APOB... 220 KEGG_2021_Human|Porphyrin and chlorophyll meta... s1 12h 0.956921 27 ALAS2_FECH;FECH_PGRMC1;ALAS2_HMBS;ALAS2_DAO;AL... 109 KEGG_2021_Human|Glycine, serine and threonine ... s1 12h 0.956739 32 BPGM_ENO2;ALAS2_FECH;ALAS2_HMBS;ALAS2_DAO;ALAS... 220 KEGG_2021_Human|Porphyrin and chlorophyll meta... s1 21h 0.954294 25 ALAS2_FECH;AHSP_ALAS2;ALAS2_HMBS;ALAS2_GYPB;AL... 220 KEGG_2021_Human|Porphyrin and chlorophyll meta... s1 0h 0.952649 33 ALAS2_FECH;FECH_PGRMC1;ALAS2_GLRX5;ALAS2_HMBS;... <pre><code>%autoreload\n\ndf = obj.get_enrich_score(metric='KS-ESD')\ndf.head()\n</code></pre> s1 -24h s1 0h s1 5h s1 12h s1 21h s1 29h s1 36h s1 45h s1 53h s1 60h s1 69h s1 77h s1 84h s1 93h s1 101h s1 108h KEGG_2021_Human|ABC transporters 0.511203 0.407616 0.176826 0.376474 0.155942 0.463461 0.186559 -0.147816 -0.278010 -0.255795 -0.178515 0.175072 -0.341155 -0.252330 -0.016976 -0.325003 KEGG_2021_Human|AGE-RAGE signaling pathway in diabetic complications 0.329535 0.219237 0.448604 0.232311 -0.145386 0.054873 0.868396 0.819802 0.823229 0.676934 0.272957 0.330748 0.140979 0.484311 0.452682 -0.136341 KEGG_2021_Human|AMPK signaling pathway 0.189554 0.271545 0.167614 0.017506 -0.186566 0.055528 -0.000044 -0.034709 -0.045422 -0.105014 0.196263 0.180146 0.139460 0.086312 0.077620 -0.248719 KEGG_2021_Human|Acute myeloid leukemia 0.105796 0.107385 0.283232 0.194244 -0.205442 -0.186339 0.319082 0.263370 0.249745 0.269883 0.323344 0.303507 0.254921 0.294108 0.143894 -0.096854 KEGG_2021_Human|Adherens junction -0.083482 -0.212193 0.053437 -0.093015 -0.327512 -0.187230 0.058383 -0.064658 -0.260653 -0.266837 0.055335 0.341037 -0.163204 -0.129680 -0.332212 -0.311838 <pre><code>%autoreload\n\ndf = obj.get_enrich_results(metric='RC-AUC')\ndf.head()\n</code></pre> Term Obs RC-AUC 47 KEGG_2021_Human|Cell cycle s1 29h 0.135191 206 KEGG_2021_Human|Pathways in cancer s1 29h 0.096017 130 KEGG_2021_Human|Human T-cell leukemia virus 1 ... s1 29h 0.087720 190 KEGG_2021_Human|Oocyte meiosis s1 29h 0.084915 53 KEGG_2021_Human|Cholesterol metabolism s1 29h 0.082279 <pre><code>%autoreload\n\ndf = obj.get_enrich_score(metric='RC-AUC')\ndf.head()\n</code></pre> s1 -24h s1 0h s1 5h s1 12h s1 21h s1 29h s1 36h s1 45h s1 53h s1 60h s1 69h s1 77h s1 84h s1 93h s1 101h s1 108h KEGG_2021_Human|ABC transporters 0.000000 0.000000 0.000000 0.000000 0.000000 0.001498 0.000034 0.000014 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 KEGG_2021_Human|AGE-RAGE signaling pathway in diabetic complications 0.000144 0.000188 0.000308 0.000275 0.000221 0.014349 0.017723 0.014877 0.009951 0.002833 0.000398 0.000276 0.000464 0.000869 0.001162 0.000677 KEGG_2021_Human|AMPK signaling pathway 0.000058 0.000151 0.000092 0.000123 0.000135 0.011477 0.000801 0.000949 0.000575 0.000338 0.000238 0.000116 0.000328 0.000247 0.000407 0.000392 KEGG_2021_Human|Acute myeloid leukemia 0.000058 0.000123 0.000146 0.000184 0.000152 0.008820 0.001616 0.001650 0.001039 0.000656 0.000333 0.000204 0.000459 0.000403 0.000458 0.000562 KEGG_2021_Human|Adherens junction 0.000000 0.000000 0.000008 0.000014 0.000011 0.002685 0.000297 0.000310 0.000133 0.000073 0.000046 0.000051 0.000055 0.000045 0.000057 0.000089 <pre><code>%autoreload\n\ndf = obj.get_enrich_results(metric='RC-nAUC')\ndf.head()\n</code></pre> Term Obs RC-nAUC 310 KEGG_2021_Human|Vitamin digestion and absorption s1 29h 0.000541 86 KEGG_2021_Human|Fat digestion and absorption s1 29h 0.000390 53 KEGG_2021_Human|Cholesterol metabolism s1 29h 0.000377 199 KEGG_2021_Human|PPAR signaling pathway s1 29h 0.000200 63 KEGG_2021_Human|Complement and coagulation cas... s1 29h 0.000138 <pre><code>%autoreload\n\ndf = obj.get_enrich_score(metric='RC-nAUC')\ndf.head()\n</code></pre> s1 -24h s1 0h s1 5h s1 12h s1 21h s1 29h s1 36h s1 45h s1 53h s1 60h s1 69h s1 77h s1 84h s1 93h s1 101h s1 108h KEGG_2021_Human|ABC transporters 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000042 9.421428e-07 3.874309e-07 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 KEGG_2021_Human|AGE-RAGE signaling pathway in diabetic complications 1.870850e-07 2.441146e-07 3.986775e-07 3.564212e-07 2.858975e-07 0.000019 2.295783e-05 1.927032e-05 1.288936e-05 3.669388e-06 5.151918e-07 3.574494e-07 6.007862e-07 1.125796e-06 1.505751e-06 8.771156e-07 KEGG_2021_Human|AMPK signaling pathway 1.072605e-07 2.801777e-07 1.704886e-07 2.279411e-07 2.507363e-07 0.000021 1.486728e-06 1.760465e-06 1.067702e-06 6.263966e-07 4.413179e-07 2.157996e-07 6.091868e-07 4.579392e-07 7.549953e-07 7.269085e-07 KEGG_2021_Human|Acute myeloid leukemia 9.757658e-08 2.074059e-07 2.447567e-07 3.088989e-07 2.547752e-07 0.000015 2.715183e-06 2.773398e-06 1.746601e-06 1.101706e-06 5.591107e-07 3.436820e-07 7.714409e-07 6.773722e-07 7.690515e-07 9.448536e-07 KEGG_2021_Human|Adherens junction 0.000000e+00 0.000000e+00 3.904824e-08 6.947202e-08 5.348219e-08 0.000013 1.443359e-06 1.506204e-06 6.464706e-07 3.540330e-07 2.254588e-07 2.498929e-07 2.686769e-07 2.182916e-07 2.762113e-07 4.331809e-07 <pre><code>%autoreload\n\ndf = obj.get_enrich_results(metric='nRC-AUC')\ndf.head()\n</code></pre> Term Obs nRC-AUC 220 KEGG_2021_Human|Porphyrin and chlorophyll meta... s1 5h 0.991810 220 KEGG_2021_Human|Porphyrin and chlorophyll meta... s1 21h 0.990207 109 KEGG_2021_Human|Glycine, serine and threonine ... s1 0h 0.990068 220 KEGG_2021_Human|Porphyrin and chlorophyll meta... s1 0h 0.989894 109 KEGG_2021_Human|Glycine, serine and threonine ... s1 12h 0.989816 <pre><code>%autoreload\n\ndf = obj.get_enrich_score(metric='nRC-AUC')\ndf.head()\n</code></pre> s1 -24h s1 0h s1 5h s1 12h s1 21h s1 29h s1 36h s1 45h s1 53h s1 60h s1 69h s1 77h s1 84h s1 93h s1 101h s1 108h KEGG_2021_Human|ABC transporters 0.718711 0.665311 0.538542 0.615976 0.548046 0.627654 0.613326 0.439840 0.351713 0.378386 0.416161 0.544981 0.272527 0.349374 0.466111 0.306033 KEGG_2021_Human|AGE-RAGE signaling pathway in diabetic complications 0.645504 0.572198 0.702981 0.580559 0.413195 0.522266 0.954440 0.930258 0.926730 0.840799 0.592138 0.615884 0.535635 0.710733 0.688033 0.416877 KEGG_2021_Human|AMPK signaling pathway 0.561423 0.598393 0.576290 0.484662 0.403737 0.513076 0.505712 0.471960 0.460665 0.426655 0.552232 0.549321 0.530229 0.500018 0.484148 0.355587 KEGG_2021_Human|Acute myeloid leukemia 0.523083 0.512464 0.621245 0.567902 0.398017 0.432257 0.671118 0.620194 0.582949 0.590875 0.636876 0.613659 0.577460 0.620615 0.530357 0.440861 KEGG_2021_Human|Adherens junction 0.435979 0.371047 0.503430 0.452619 0.291266 0.408459 0.538561 0.470905 0.340907 0.357279 0.503653 0.639332 0.405177 0.413240 0.299706 0.282959 <pre><code>%autoreload\nterm = 'KEGG_2021_Human|Oocyte meiosis'\nobs_id = 's1 -24h'\nfig = obj.pl_running_sum('KS-ES', term, obs_id)\nfig\n</code></pre> <pre><code>%autoreload\nterm = 'KEGG_2021_Human|Oocyte meiosis'\nobs_id = 's1 -24h'\nfig = obj.pl_running_sum('KS-ESD', term, obs_id)\nfig\n</code></pre> <pre><code>%autoreload\nterm = 'KEGG_2021_Human|Oocyte meiosis'\nobs_id = 's1 -24h'\nfig = obj.pl_running_sum('RC-AUC', term, obs_id)\nfig\n</code></pre> <pre><code>%autoreload\nterm = 'KEGG_2021_Human|Oocyte meiosis'\nobs_id = 's1 -24h'\nfig = obj.pl_running_sum('RC-nAUC', term, obs_id)\nfig\n</code></pre> <pre><code>%autoreload\nterm = 'KEGG_2021_Human|Oocyte meiosis'\nobs_id = 's1 -24h'\nfig = obj.pl_running_sum('nRC-AUC', term, obs_id)\nfig\n</code></pre>"},{"location":"tutorial/interaction-obs_prerank_enrich/#obs_prerank_enrich-enrichment-gene-interaction-list-with-rank-scores-for-observations","title":"<code>obs_prerank_enrich()</code> Enrichment: Gene Interaction List with Rank Scores for Observations","text":""},{"location":"tutorial/interaction-obs_prerank_enrich/#step-1-prepare-rank_df","title":"Step 1: Prepare <code>rank_df</code>","text":"<p>Begin by preparing a list of gene interactions along with their preranked scores. Store this information in a DataFrame called <code>rank_df</code>.</p> <ul> <li>The index of <code>rank_df</code> should be the gene interaction symbols. e.g. <code>A1CF_APOB</code></li> <li>The columns of <code>rank_df</code> should correspond to observation IDs (e.g., sample or cell identifier).</li> </ul> <p>This format allows <code>obs_prerank_enrich()</code> to perform enrichment analysis using observation-level ranked interaction-level statistics.</p> <p>In this tutorial, we use gene interaction data from the GSE30550 dataset for H3N2-infected subjects sampling across time. </p> <p>For each sample, gene\u2013gene interactions and their corresponding entropy-based Critical Transition (CT) scores were precomputed by CRISGI (<code>grea/data/GSE30550_H3N2_CRISGI_score.csv</code>).</p>"},{"location":"tutorial/interaction-obs_prerank_enrich/#step-2-preparing-gene-set-libraries","title":"Step 2: Preparing Gene Set Libraries","text":"<p>There are several ways to prepare gene set libraries for use in GREA:</p>"},{"location":"tutorial/interaction-obs_prerank_enrich/#option-1-use-built-in-libraries","title":"Option 1: Use Built-in Libraries","text":"<p>Simply specify the <code>libraries</code> you're interested in as a list. For example:</p> <pre><code>libraries = ['KEGG_2021_Human']\n</code></pre> <p>You can use the <code>grea.library.list_libraries()</code> function to view all available pathway libraries included in GREA.</p>"},{"location":"tutorial/interaction-obs_prerank_enrich/#option-2-load-from-gmt-file","title":"Option 2: Load from GMT File","text":"<p>You can load external gene set libraries from <code>.gmt</code> files using:</p> <pre><code>libraries = read_gmt('your_library_file.gmt')\n</code></pre>"},{"location":"tutorial/interaction-obs_prerank_enrich/#option-3-define-a-custom-library","title":"Option 3: Define a Custom Library","text":"<p>Create your own gene set library using a Python dictionary, where each key is a pathway name and the corresponding value is a list of genes:</p> <pre><code>libraries = {\n    'term1': ['A2M', 'APP'],\n    'term2': ['A1CF', 'APOB']\n}\n</code></pre>"},{"location":"tutorial/interaction-obs_prerank_enrich/#step-3-run-enrichment","title":"Step 3: Run Enrichment","text":"<p>To perform enrichment analysis, call the <code>grea.obs_prerank_enrich(rank_df, libraries)</code> function. The observation-level enrichment do not estimate the p-value for efficiency. You can customize the analysis using the following arguments:</p> <ul> <li><code>sig_sep</code>: The delimiter used to separate gene names in an interaction string (e.g., set <code>sig_sep='_'</code> for interactions like <code>A2M_AMBP</code>).</li> </ul> <p>The function returns a GREA object containing all enrichment results, including enrichment scores and statistical significance for each library term.</p>"},{"location":"tutorial/interaction-obs_prerank_enrich/#step-4-check-enrichment-results","title":"Step 4: Check Enrichment Results","text":"<p>The <code>GREA</code> object stores all enrichment results, including enrichment scores and statistical significance for each library term. GREA supports three types of enrichment scores, each reflecting a different scoring strategy:</p> <ul> <li><code>'KS-ES'</code>: Kolmogorov\u2013Smirnov-based Enrichment Score, capturing the peak deviation between hit and miss distributions.</li> <li><code>'KS-ESD'</code>: KS-based enrichment Score Difference, the sum of the maximum positive and negative deviations from the running score.</li> <li><code>'RC-AUC'</code>: Area Under the Recovery Curve, summarizing early enrichment of target genes along the ranking.</li> <li><code>'RC-nAUC'</code>: The normalized Area Under the Recovery Curve, summarizing early enrichment of target genes along the ranking.</li> <li><code>'nRC-AUC'</code>: Area Under the normalized Recovery Curve, summarizing early enrichment of target genes along the ranking, ranges from 0 to 1.</li> </ul> <p>You can select the appropriate metric depending on your analysis goal or data characteristics.</p> <p>To retrieve the enrichment results as a long DataFrame, use the <code>get_enrich_results(metric)</code> function, as a wide DataFrame, use the <code>get_enrich_score(metric)</code>.</p>"},{"location":"tutorial/interaction-obs_prerank_enrich/#step-5-visualize-enrichment-results","title":"Step 5: Visualize Enrichment Results","text":"<p>To visualize the enrichment results, use the <code>pl_running_sum(metric, term, obs_id)</code> function by specifying the desired metric, term, and observation ID.</p>"},{"location":"tutorial/interaction-pheno_prerank_enrich/","title":"Phenotype-level prerank enrichment for gene interactions","text":"<pre><code>%load_ext autoreload\n\nimport pandas as pd\nrank_df = pd.read_csv(\"grea/db/GSE13268_GK.csv\", index_col=0)\nrank_df.head()\n</code></pre> <pre>\n<code>The autoreload extension is already loaded. To reload it, use:\n  %reload_ext autoreload\n</code>\n</pre> GK vs. WKY names Ifit3_Ifit1 7.116836 Usp18_Ifit1 7.105887 Oas1a_Ifit1 7.105887 Gstm4_Gsta4 7.094938 Gstt1_Gsta4 7.094938 <pre><code>%autoreload\nfrom grea.library import list_libraries\n\nprint(list_libraries())\n</code></pre> <pre>\n<code>['GeneSigDB', 'Enrichr_Submissions_TF-Gene_Coocurrence', 'SysMyo_Muscle_Gene_Sets', 'WikiPathway_2021_Human', 'HomoloGene', 'WikiPathways_2013', 'PFOCR_Pathways_2023', 'OMIM_Disease', 'Data_Acquisition_Method_Most_Popular_Genes', 'NIBR_Jensen_DISEASES_Curated_2025', 'Cancer_Cell_Line_Encyclopedia', 'WikiPathways_2016', 'WikiPathways_2015', 'RNAseq_Automatic_GEO_Signatures_Human_Up', 'Human_Gene_Atlas', 'KOMP2_Mouse_Phenotypes_2022', 'MoTrPAC_2023', 'Kinase_Perturbations_from_GEO_down', 'Disease_Signatures_from_GEO_down_2014', 'Disease_Perturbations_from_GEO_up', 'Old_CMAP_down', 'MCF7_Perturbations_from_GEO_up', 'NIH_Funded_PIs_2017_GeneRIF_ARCHS4_Predictions', 'DepMap_WG_CRISPR_Screens_Sanger_CellLines_2019', 'PPI_Hub_Proteins', 'Disease_Signatures_from_GEO_up_2014', 'GTEx_Tissue_Expression_Up', 'NIBR_DRUGseq_2025_down', 'L1000_Kinase_and_GPCR_Perturbations_up', 'ARCHS4_Cell-lines', 'VirusMINT', 'KEGG_2019_Human', 'ARCHS4_Tissues', 'MGI_Mammalian_Phenotype_Level_4', 'The_Kinase_Library_2024', 'The_Kinase_Library_2023', 'MGI_Mammalian_Phenotype_Level_3', 'InterPro_Domains_2019', 'WikiPathways_2024_Mouse', 'DRUGseq_2025_up', 'KEGG_2015', 'MSigDB_Computational', 'KEGG_2013', 'TF-LOF_Expression_from_GEO', 'GWAS_Catalog_2019', 'KEGG_2016', 'NCI-Nature_2015', 'NCI-Nature_2016', 'CCLE_Proteomics_2020', 'PheWeb_2019', 'GeDiPNet_2023', 'RNA-Seq_Disease_Gene_and_Drug_Signatures_from_GEO', 'LINCS_L1000_Chem_Pert_down', 'Old_CMAP_up', 'LINCS_L1000_Ligand_Perturbations_down', 'Enrichr_Users_Contributed_Lists_2020', 'NIH_Funded_PIs_2017_Human_GeneRIF', 'Jensen_TISSUES', 'Azimuth_Cell_Types_2021', 'DisGeNET', 'Panther_2016', 'LINCS_L1000_Ligand_Perturbations_up', 'Rare_Diseases_AutoRIF_Gene_Lists', 'Achilles_fitness_increase', 'TargetScan_microRNA', 'Panther_2015', 'WikiPathways_2019_Mouse', 'ARCHS4_TFs_Coexp', 'LINCS_L1000_Chem_Pert_up', 'MSigDB_Oncogenic_Signatures', 'Gene_Perturbations_from_GEO_down', 'Table_Mining_of_CRISPR_Studies', 'Rare_Diseases_GeneRIF_Gene_Lists', 'Ligand_Perturbations_from_GEO_down', 'SILAC_Phosphoproteomics', 'Ligand_Perturbations_from_GEO_up', 'Drug_Perturbations_from_GEO_up', 'SynGO_2022', 'MGI_Mammalian_Phenotype_Level_4_2024', 'SynGO_2024', 'Allen_Brain_Atlas_10x_scRNA_2021', 'MGI_Mammalian_Phenotype_Level_4_2021', 'ClinVar_2019', 'GWAS_Catalog_2023', 'MAGMA_Drugs_and_Diseases', 'KEA_2015', 'KEA_2013', 'Microbe_Perturbations_from_GEO_up', 'Chromosome_Location', 'COVID-19_Related_Gene_Sets_2021', 'MGI_Mammalian_Phenotype_Level_4_2019', 'DRUGseqr_2025_down', 'ARCHS4_IDG_Coexp', 'NIH_Funded_PIs_2017_AutoRIF_ARCHS4_Predictions', 'Jensen_DISEASES_Experimental_2025', 'lncHUB_lncRNA_Co-Expression', 'PerturbAtlas', 'DrugMatrix', 'Virus_Perturbations_from_GEO_down', 'huMAP', 'L1000_Kinase_and_GPCR_Perturbations_down', 'Elsevier_Pathway_Collection', 'NIH_Funded_PIs_2017_Human_AutoRIF', 'Diabetes_Perturbations_GEO_2022', 'ESCAPE', 'RNAseq_Automatic_GEO_Signatures_Mouse_Down', 'UK_Biobank_GWAS_v1', 'Aging_Perturbations_from_GEO_up', 'Human_Phenotype_Ontology', 'Jensen_DISEASES_Curated_2025', 'Proteomics_Drug_Atlas_2023', 'dbGaP', 'SubCell_BarCode', 'Transcription_Factor_PPIs', 'GO_Cellular_Component_2017b', 'HuBMAP_ASCTplusB_augmented_2022', 'MSigDB_Hallmark_2020', 'GlyGen_Glycosylated_Proteins_2022', 'MAGNET_2023', 'CellMarker_2024', 'BioPlanet_2019', 'HDSigDB_Human_2021', 'GTEx_Tissues_V8_2023', 'GTEx_Tissue_Expression_Down', 'Metabolomics_Workbench_Metabolites_2022', 'Tissue_Protein_Expression_from_Human_Proteome_Map', 'Epigenomics_Roadmap_HM_ChIP-seq', 'PhenGenI_Association_2021', 'MCF7_Perturbations_from_GEO_down', 'ProteomicsDB_2020', 'Virus-Host_PPI_P-HIPSTer_2020', 'OMIM_Expanded', 'Reactome_2022', 'Genes_Associated_with_NIH_Grants', 'CellMarker_Augmented_2021', 'ENCODE_and_ChEA_Consensus_TFs_from_ChIP-X', 'HDSigDB_Mouse_2021', 'Jensen_COMPARTMENTS', 'ChEA_2015', 'ChEA_2016', 'KEGG_2019_Mouse', 'ChEA_2022', 'LINCS_L1000_Chem_Pert_Consensus_Sigs', 'Drug_Perturbations_from_GEO_2014', 'TargetScan_microRNA_2017', 'KEGG_2021_Mouse', 'Allen_Brain_Atlas_down', 'WikiPathways_2019_Human', 'Reactome_2013', 'BioCarta_2013', 'Rummagene_transcription_factors', 'Gene_Perturbations_from_GEO_up', 'GO_Cellular_Component_2015', 'Rummagene-signatures', 'GO_Cellular_Component_2013', 'BioCarta_2016', 'NIBR_Jensen_DISEASES_Experimental_2025', 'BioCarta_2015', 'Reactome_2015', 'Reactome_2016', 'GO_Cellular_Component_2018', 'GO_Cellular_Component_2017', 'GO_Cellular_Component_2023', 'GO_Cellular_Component_2021', 'WikiPathway_2021_Mouse', 'ENCODE_TF_ChIP-seq_2015', 'ENCODE_TF_ChIP-seq_2014', 'RNAseq_Automatic_GEO_Signatures_Mouse_Up', 'GO_Molecular_Function_2017b', 'DRUGseq_2025_down', 'FANTOM6_lncRNA_KD_DEGs', 'MGI_Mammalian_Phenotype_2013', 'GO_Cellular_Component_2025', 'HMS_LINCS_KinomeScan', 'NCI-60_Cancer_Cell_Lines', 'Azimuth_2023', 'MGI_Mammalian_Phenotype_2017', 'Rare_Diseases_GeneRIF_ARCHS4_Predictions', 'Virus_Perturbations_from_GEO_up', 'PFOCR_Pathways', 'IDG_Drug_Targets_2022', 'Enrichr_Libraries_Most_Popular_Genes', 'Orphanet_Augmented_2021', 'NIBR_DRUGseq_2025_up', 'GO_Biological_Process_2021', 'TRANSFAC_and_JASPAR_PWMs', 'Reactome_Pathways_2024', 'GO_Biological_Process_2023', 'Rare_Diseases_AutoRIF_ARCHS4_Predictions', 'COVID-19_Related_Gene_Sets', 'Kinase_Perturbations_from_GEO_up', 'Descartes_Cell_Types_and_Tissue_2021', 'Tabula_Muris', 'Tabula_Sapiens', 'GO_Biological_Process_2025', 'TF_Perturbations_Followed_by_Expression', 'Rummagene_kinases', 'GTEx_Aging_Signatures_2021', 'WikiPathways_2024_Human', 'Tissue_Protein_Expression_from_ProteomicsDB', 'DGIdb_Drug_Targets_2024', 'Serine_Threonine_Kinome_Atlas_2023', 'Aging_Perturbations_from_GEO_down', 'DepMap_CRISPR_GeneDependency_CellLines_2023', 'GO_Biological_Process_2013', 'GO_Biological_Process_2017b', 'GO_Biological_Process_2018', 'CORUM', 'GO_Biological_Process_2015', 'Phosphatase_Substrates_from_DEPOD', 'BioPlex_2017', 'TRRUST_Transcription_Factors_2019', 'GO_Biological_Process_2017', 'Pfam_InterPro_Domains', 'HuBMAP_ASCT_plus_B_augmented_w_RNAseq_Coexpression', 'Pfam_Domains_2019', 'WikiPathway_2023_Human', 'Allen_Brain_Atlas_up', 'Genome_Browser_PWMs', 'NURSA_Human_Endogenous_Complexome', 'HumanCyc_2015', 'HumanCyc_2016', 'Rummagene_signatures', 'Chromosome_Location_hg19', 'Mouse_Gene_Atlas', 'ChEA_2013', 'miRTarBase_2017', 'GO_Molecular_Function_2023', 'Jensen_DISEASES', 'RNAseq_Automatic_GEO_Signatures_Human_Down', 'GO_Molecular_Function_2025', 'Rummagene-transcription-factors', 'ARCHS4_Kinases_Coexp', 'Microbe_Perturbations_from_GEO_down', 'DRUGseqr_2025_up', 'PanglaoDB_Augmented_2021', 'ENCODE_Histone_Modifications_2013', 'ENCODE_Histone_Modifications_2015', 'Achilles_fitness_decrease', 'DSigDB', 'DepMap_WG_CRISPR_Screens_Broad_CellLines_2019', 'Disease_Perturbations_from_GEO_down', 'Drug_Perturbations_from_GEO_down', 'GO_Molecular_Function_2021', 'GO_Molecular_Function_2017', 'GO_Molecular_Function_2018', 'Mitchell_Proteomics_Drug_Atlas_2023', 'GO_Molecular_Function_2013', 'GO_Molecular_Function_2015', 'Rummagene-kinases', 'TG_GATES_2020', 'KEGG_2021_Human', 'HMDB_Metabolites', 'LINCS_L1000_CRISPR_KO_Consensus_Sigs']\n</code>\n</pre> <pre><code>%autoreload\n\nfrom grea import grea\nlibraries = ['WikiPathways_2024_Mouse', 'Mouse_Gene_Atlas']\nn_perm = 10\nprob_method = 'perm'\nsig_sep = '_'\nobj = grea.pheno_prerank_enrich(rank_df, libraries,n_perm=n_perm, prob_method=prob_method, sig_sep=sig_sep)\nobj\n</code></pre> <pre>\n<code>---Finished: Load WikiPathways_2024_Mouse with 188 terms.\n---WARMING: \"Mouse_Gene_Atlas-testis\" has 3059 genes, larger than max_size 1000, filter it out.\n---Finished: Load Mouse_Gene_Atlas with 95 terms.\nLow numer of permutations can lead to inaccurate p-value estimation. Symmetric Gamma distribution enabled to increase accuracy.\n---WARMING: 98.0% of entries has zero overlap ratio.\n\n</code>\n</pre> <pre>\n<code>&lt;grea.grea._GREA at 0x200e9721be0&gt;</code>\n</pre> <pre><code>%autoreload\n\ndf = obj.get_enrich_results(metric='KS-ES')\ndf.head()\n</code></pre> Term Obs KS-ES Prob_method KS-ES_pval N_lead_sigs Lead_sigs KS-ES_fdr KS-ES_sidak 109 WikiPathways_2024_Mouse|Pentose Phosphate Path... GK vs. WKY 0.741123 perm 0.01 40 Taldo1_Gpi;Taldo1_Eno1;Tkt_Pdhb;Tkt_Taldo1;Tkt... 0.014588 0.941822 209 Mouse_Gene_Atlas|mammary gland  lact GK vs. WKY 0.676365 perm 0.01 123 Pik3r1_Mtor;Pik3r1_Pdgfrb;Pik3r1_Grap2;Pik3r1_... 0.014588 0.941822 169 WikiPathways_2024_Mouse|Heme Biosynthesis WP18 GK vs. WKY 0.651665 perm 0.01 16 Fech_Abcb10;Alas2_Alad;Fech_Abcb6;Uros_Cpox;Sl... 0.014588 0.941822 183 WikiPathways_2024_Mouse|Methylation WP1247 GK vs. WKY 0.625270 perm 0.01 44 Cyp1a1_Comt;Drd4_Comt;Comt_Aldh3b1;Ugt2b10_Com... 0.014588 0.941822 3 WikiPathways_2024_Mouse|Dysregulated miRNA Tar... GK vs. WKY 0.619595 perm 0.01 189 Pik3r1_Mtor;Pik3r1_Pdgfrb;Pik3r1_Grap2;Pik3r1_... 0.014588 0.941822 <pre><code>%autoreload\n\ndf = obj.get_enrich_results(metric='KS-ESD')\ndf.head()\n</code></pre> Term Obs KS-ESD Prob_method KS-ESD_pval N_lead_sigs Lead_sigs KS-ESD_fdr KS-ESD_sidak 109 WikiPathways_2024_Mouse|Pentose Phosphate Path... GK vs. WKY 0.731309 perm 0.01 40 Taldo1_Gpi;Taldo1_Eno1;Tkt_Pdhb;Tkt_Taldo1;Tkt... 0.014221 0.941822 209 Mouse_Gene_Atlas|mammary gland  lact GK vs. WKY 0.675842 perm 0.01 123 Pik3r1_Mtor;Pik3r1_Pdgfrb;Pik3r1_Grap2;Pik3r1_... 0.014221 0.941822 169 WikiPathways_2024_Mouse|Heme Biosynthesis WP18 GK vs. WKY 0.640218 perm 0.01 16 Fech_Abcb10;Alas2_Alad;Fech_Abcb6;Uros_Cpox;Sl... 0.014221 0.941822 183 WikiPathways_2024_Mouse|Methylation WP1247 GK vs. WKY 0.620004 perm 0.01 44 Cyp1a1_Comt;Drd4_Comt;Comt_Aldh3b1;Ugt2b10_Com... 0.014221 0.941822 3 WikiPathways_2024_Mouse|Dysregulated miRNA Tar... GK vs. WKY 0.619071 perm 0.01 189 Pik3r1_Mtor;Pik3r1_Pdgfrb;Pik3r1_Grap2;Pik3r1_... 0.014221 0.941822 <pre><code>%autoreload\n\ndf = obj.get_enrich_results(metric='RC-AUC')\ndf.head()\n</code></pre> Term Obs RC-AUC Prob_method RC-AUC_pval RC-AUC_fdr RC-AUC_sidak 16 WikiPathways_2024_Mouse|Focal Adhesion PI3K Ak... GK vs. WKY 2466.959341 perm 0.01 0.03043 0.941822 246 Mouse_Gene_Atlas|embryonic stem line Bruce4 p13 GK vs. WKY 2176.005442 perm 0.99 0.99000 1.000000 171 WikiPathways_2024_Mouse|Insulin Signaling WP65 GK vs. WKY 1972.318166 perm 0.01 0.03043 0.941822 266 Mouse_Gene_Atlas|embryonic stem line V26 2 p16 GK vs. WKY 1819.335029 perm 0.99 0.99000 1.000000 118 WikiPathways_2024_Mouse|EGFR1 Signaling Pathwa... GK vs. WKY 1807.684383 perm 0.01 0.03043 0.941822 <pre><code>%autoreload\n\ndf = obj.get_enrich_results(metric='RC-nAUC')\ndf.head()\n</code></pre> Term Obs RC-nAUC Prob_method RC-nAUC_pval RC-nAUC_fdr RC-nAUC_sidak 169 WikiPathways_2024_Mouse|Heme Biosynthesis WP18 GK vs. WKY 1.076391 perm 0.01 0.03043 0.941822 209 Mouse_Gene_Atlas|mammary gland  lact GK vs. WKY 1.005294 perm 0.01 0.03043 0.941822 109 WikiPathways_2024_Mouse|Pentose Phosphate Path... GK vs. WKY 0.931951 perm 0.01 0.03043 0.941822 3 WikiPathways_2024_Mouse|Dysregulated miRNA Tar... GK vs. WKY 0.929094 perm 0.01 0.03043 0.941822 183 WikiPathways_2024_Mouse|Methylation WP1247 GK vs. WKY 0.842388 perm 0.01 0.03043 0.941822 <pre><code>%autoreload\n\ndf = obj.get_enrich_results(metric='nRC-AUC')\ndf.head()\n</code></pre> Term Obs nRC-AUC Prob_method nRC-AUC_pval nRC-AUC_fdr nRC-AUC_sidak 109 WikiPathways_2024_Mouse|Pentose Phosphate Path... GK vs. WKY 0.914688 perm 0.01 0.026204 0.941822 183 WikiPathways_2024_Mouse|Methylation WP1247 GK vs. WKY 0.875713 perm 0.01 0.026204 0.941822 169 WikiPathways_2024_Mouse|Heme Biosynthesis WP18 GK vs. WKY 0.860808 perm 0.01 0.026204 0.941822 3 WikiPathways_2024_Mouse|Dysregulated miRNA Tar... GK vs. WKY 0.822837 perm 0.01 0.026204 0.941822 86 WikiPathways_2024_Mouse|Non Homologous End Joi... GK vs. WKY 0.820583 perm 0.01 0.026204 0.941822 <pre><code>%autoreload\nterm = 'Mouse_Gene_Atlas|uterus'\npheno_id = 'GK vs. WKY'\nfig = obj.pl_running_sum('KS-ES', term, pheno_id)\nfig\n</code></pre> <pre><code>%autoreload\nterm = 'Mouse_Gene_Atlas|uterus'\npheno_id = 'GK vs. WKY'\nfig = obj.pl_running_sum('KS-ESD', term, pheno_id)\nfig\n</code></pre> <pre><code>%autoreload\nterm = 'Mouse_Gene_Atlas|uterus'\npheno_id = 'GK vs. WKY'\nfig = obj.pl_running_sum('RC-AUC', term, pheno_id)\nfig\n</code></pre> <pre><code>%autoreload\nterm = 'Mouse_Gene_Atlas|uterus'\npheno_id = 'GK vs. WKY'\nfig = obj.pl_running_sum('RC-nAUC', term, pheno_id)\nfig\n</code></pre> <pre><code>%autoreload\nterm = 'Mouse_Gene_Atlas|uterus'\npheno_id = 'GK vs. WKY'\nfig = obj.pl_running_sum('nRC-AUC', term, pheno_id)\nfig\n</code></pre>"},{"location":"tutorial/interaction-pheno_prerank_enrich/#pheno_prerank_enrich-enrichment-gene-interaction-list-with-rank-scores-for-phenotypes","title":"<code>pheno_prerank_enrich()</code> Enrichment: Gene Interaction List with Rank Scores for Phenotypes","text":""},{"location":"tutorial/interaction-pheno_prerank_enrich/#step-1-prepare-rank_df","title":"Step 1: Prepare <code>rank_df</code>","text":"<p>Begin by preparing a list of gene interactions along with their preranked scores. Store this information in a DataFrame called <code>rank_df</code>.</p> <ul> <li>The index of <code>rank_df</code> should be the gene interaction symbols. e.g. <code>Oas1a_Ifit1</code></li> <li>The columns of <code>rank_df</code> should correspond to one target phenotype (e.g., GK vs.).</li> </ul> <p>This format allows <code>pheno_prerank_enrich</code> to perform enrichment analysis using phenotype-level ranked interaction-level statistics.</p> <p>In this tutorial, we use gene interaction data from the GSE13268 dataset, which includes two phenotypes:</p> <ul> <li> <p>GK (Goto-Kakizaki): An inbred rat model commonly used for diabetes research. GK rats exhibit a polygenic form of diabetes, closely mirroring human disease characteristics such as hyperglycemia, impaired glucose tolerance, and insulin resistance. This makes them a valuable model for studying human type 2 diabetes.</p> </li> <li> <p>WKY (Wistar-Kyoto): A standard inbred laboratory rat strain often used as a control. In this study, WKY rats serve as the reference group for comparison with GK rats, enabling the investigation of insulin resistance and diabetes progression.</p> </li> </ul> <p>For each rat sample, gene\u2013gene interactions and their corresponding entropy-based Critical Transition (CT) scores were precomputed by NIEE. A differential analysis was then performed between the GK and WKY groups. From this, we identified gene interactions with higher fluctuation in GK rats, ranked by their z-scores from the differential test (<code>grea/data/GSE13268_GK.csv</code>).</p>"},{"location":"tutorial/interaction-pheno_prerank_enrich/#step-2-preparing-gene-set-libraries","title":"Step 2: Preparing Gene Set Libraries","text":"<p>There are several ways to prepare gene set libraries for use in GREA:</p>"},{"location":"tutorial/interaction-pheno_prerank_enrich/#option-1-use-built-in-libraries","title":"Option 1: Use Built-in Libraries","text":"<p>Simply specify the <code>libraries</code> you're interested in as a list. For example:</p> <pre><code>libraries = ['KEGG_2019_Mouse', 'WikiPathways_2024_Mouse']\n</code></pre> <p>You can use the <code>grea.library.list_libraries()</code> function to view all available pathway libraries included in GREA.</p>"},{"location":"tutorial/interaction-pheno_prerank_enrich/#option-2-load-from-gmt-file","title":"Option 2: Load from GMT File","text":"<p>You can load external gene set libraries from <code>.gmt</code> files using:</p> <pre><code>libraries = read_gmt('your_library_file.gmt')\n</code></pre>"},{"location":"tutorial/interaction-pheno_prerank_enrich/#option-3-define-a-custom-library","title":"Option 3: Define a Custom Library","text":"<p>Create your own gene set library using a Python dictionary, where each key is a pathway name and the corresponding value is a list of genes:</p> <pre><code>libraries = {\n    'term1': ['Oas1a', 'Ifit1'],\n    'term2': ['Gstm4', 'Oas1a']\n}\n</code></pre>"},{"location":"tutorial/interaction-pheno_prerank_enrich/#step-3-run-enrichment","title":"Step 3: Run Enrichment","text":"<p>To perform enrichment analysis, call the <code>grea.pheno_prerank_enrich(rank_df, libraries)</code> function. You can customize the analysis using the following arguments:</p> <ul> <li><code>prob_method</code>: Method for p-value calculation. Currently supports <code>'perm'</code> for permutation-based testing.</li> <li><code>n_perm</code>: Number of permutations to use for estimating the null distribution.</li> <li><code>sig_sep</code>: The delimiter used to separate gene names in an interaction string (e.g., set <code>sig_sep='_'</code> for interactions like <code>Oas1a_Ifit1</code>).</li> </ul> <p>The function returns a GREA object containing all enrichment results, including enrichment scores and statistical significance for each library term.</p>"},{"location":"tutorial/interaction-pheno_prerank_enrich/#step-4-check-enrichment-results","title":"Step 4: Check Enrichment Results","text":"<p>The <code>GREA</code> object stores all enrichment results, including enrichment scores and statistical significance for each library term. GREA supports three types of enrichment scores, each reflecting a different scoring strategy:</p> <ul> <li><code>'KS-ES'</code>: Kolmogorov\u2013Smirnov-based Enrichment Score, capturing the peak deviation between hit and miss distributions.</li> <li><code>'KS-ESD'</code>: KS-based enrichment Score Difference, the sum of the maximum positive and negative deviations from the running score.</li> <li><code>'RC-AUC'</code>: Area Under the Recovery Curve, summarizing early enrichment of target genes along the ranking.</li> <li><code>'RC-nAUC'</code>: The normalized Area Under the Recovery Curve, summarizing early enrichment of target genes along the ranking.</li> <li><code>'nRC-AUC'</code>: Area Under the normalized Recovery Curve, summarizing early enrichment of target genes along the ranking, ranges from 0 to 1.</li> </ul> <p>You can select the appropriate metric depending on your analysis goal or data characteristics.</p> <p>To retrieve the enrichment results as a long DataFrame, use the <code>get_enrich_results(metric)</code> function.</p>"},{"location":"tutorial/interaction-pheno_prerank_enrich/#step-5-visualize-enrichment-results","title":"Step 5: Visualize Enrichment Results","text":"<p>To visualize the enrichment results, use the <code>pl_running_sum(metric, term, pheno_id)</code> function by specifying the desired metric, term, and target phenotype.</p>"}]}